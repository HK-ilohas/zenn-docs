---
title: "ã€åŠ›å­¦ç³»è¶…å…¥é–€ã€‘å¹³è¡¡ç‚¹ã®åˆ†å²ï¼šç·šå½¢å®‰å®šæ€§è§£æã€Pythonã€‘"
emoji: "ğŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["python", "åŠ›å­¦ç³»"]
published: true
---

## 1. åŠ›å­¦ç³»

### åŠ›å­¦ç³»ã¨ã¯

**åŠ›å­¦ç³»**ï¼ˆDynamical Systemï¼‰ã¯ã€æ™‚é–“ã¨ã‚‚ã«å‹•çš„ã«å¤‰åŒ–ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ„å‘³ã™ã‚‹ã€‚åŠ›å­¦ç³»ã®ç›®çš„ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®çŠ¶æ…‹ãŒã©ã®ã‚ˆã†ã«æ™‚é–“ç™ºå±•ã™ã‚‹ã‹ã‚’ç†è§£ã—ã€ãã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ç‰¹æ€§ã‚’è§£æã™ã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚

ä¾‹ãˆã°ã€ã“ã‚Œã¾ã§ä»¥ä¸‹ã®ã‚ˆã†ãªåˆ†é‡ã§å¿œç”¨ã•ã‚Œã¦ããŸã€‚

- ç‰©ç†å­¦ï¼šå¤©ä½“åŠ›å­¦
- å·¥å­¦ï¼šåˆ¶å¾¡ç†è«–ã€é›»æ°—å›è·¯
- ç”Ÿç‰©å­¦ï¼šç”Ÿæ…‹ç³»ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°
- çµŒæ¸ˆå­¦ï¼šå¸‚å ´ã®ãƒ€ã‚¤ãƒŠãƒŸã‚¯ã‚¹
  
ä¸Šè¨˜ã®å†…å®¹ã‚’è¦‹ã¦ã‚ã‹ã‚‹é€šã‚Šã€åŠ›å­¦ç³»ã¯é€£ç¶šæ™‚é–“ã®**å¾®åˆ†æ–¹ç¨‹å¼**ã¨é›¢æ•£æ™‚é–“ã®**å·®åˆ†æ–¹ç¨‹å¼**ã§æ•°ç†ãƒ¢ãƒ‡ãƒ«åŒ–ã•ã‚ŒãŸã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦å–ã‚Šæ‰±ã†ã€‚

ã“ã®è¨˜äº‹ã§ã¯åŠ›å­¦ç³»ã®åˆ†å²ã«ã¤ã„ã¦èª¬æ˜ã™ã‚‹ã€‚å…ƒãƒã‚¿ã¯å°å®¤å…ƒæ”¿[ã€æ–°ç‰ˆ åŸºç¤ã‹ã‚‰ã®åŠ›å­¦ç³» åˆ†å²è§£æã‹ã‚‰ã‚«ã‚ªã‚¹çš„éæ­´ã¸ã€](https://www.saiensu.co.jp/search/?isbn=978-4-7819-1118-2&y=2005)ã§ã‚ã‚‹ã€‚ã¨ã„ã†ã‹ã€ã“ã®æœ¬ã‚’å‹‰å¼·ã—ã¦ã„ã‚‹ã¨ãã®ãƒãƒ¼ãƒˆã‚’æŠœç²‹ï¼†æ•´ç†ã—ãŸã®ãŒã“ã®è¨˜äº‹ã§ã‚ã‚‹ï¼ˆãã®ãŸã‚ã€åŸºæœ¬çš„ãªæµã‚Œã‚„è¨˜è¿°ãŒå¤§ããé¡ä¼¼ã—ã¦ã„ã‚‹ï¼‰ã€‚ã“ã®æœ¬ã§ã¯å¤ã„C++ã®ã‚½ãƒ•ãƒˆã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ è¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚’Pythonã§æ”¹ã‚ã¦æ›¸ã“ã†ã¨ã„ã†ã®ãŒå®Ÿã¯ãã‚‚ãã‚‚ã®ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ã£ãŸãŒã€æ°—ãŒä»˜ã„ãŸã‚‰ã‹ãªã‚Šã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ã«ãªã£ã¦ã—ã¾ã£ãŸã€‚

:::details Pythonç’°å¢ƒã«ã¤ã„ã¦
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼š3.12.3

```bash
$ pip install setuptools
$ pip install numpy
$ pip install scipy
$ pip install matplotlib
$ pip install japanize-matplotlib
```
:::


### å˜æŒ¯ã‚Šå­

ç°¡å˜ãªåŠ›å­¦ç³»ã®ä¾‹ã¨ã—ã¦å˜æŒ¯ã‚Šå­ã‚’ç´¹ä»‹ã—ã€åŠ›å­¦ç³»ã®åŸºæœ¬çš„ãªæ¦‚å¿µã‚’å°å…¥ã™ã‚‹ã€‚

![](/images/dynamic-bunki/furiko.png =400x)

ã¾ãšæ‘©æ“¦ã‚„ç©ºæ°—æŠµæŠ—ã‚’ç„¡è¦–ã—ãŸå ´åˆã€å˜æŒ¯ã‚Šå­ã®å¾®åˆ†æ–¹ç¨‹å¼ã¯æ¬¡ã®é€šã‚Šã§ã‚ã‚‹ã€‚ãŸã ã—ã€$\dot{}=\frac{d}{dt}$ ã§ã‚ã‚‹ã€‚

$$
\begin{equation*}
\begin{cases}
\dot{\theta} = \omega \\
\dot{\omega} = -\frac{g}{l} \sin\theta
\end{cases}
\end{equation*}
$$

$(\theta, \omega)$-å¹³é¢ï¼ˆ**ç›¸ç©ºé–“**ï¼‰ã‚’è€ƒãˆã€å„ç‚¹ $(\theta,\omega)$ ã«ãƒ™ã‚¯ãƒˆãƒ«

$$
\left(\dot{\theta}, \dot{\omega}\right) = \left( \omega, -\frac{g}{l} \sin\theta \right)
$$

ã‚’å¯¾å¿œã•ã›ã‚‹ã€‚ã“ã®å†™åƒã‚’**ãƒ™ã‚¯ãƒˆãƒ«å ´**ã¨ã„ã†ã€‚

$g/l=1$ ã¨ã—ã¦ã€ã“ã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã‚’Pythonã§æç”»ã™ã‚‹ã¨ä»¥ä¸‹ã®é€šã‚Šã§ã‚ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib

gL = 1.0

theta_values = np.linspace(-2 * np.pi, 2 * np.pi, 20)
omega_values = np.linspace(-5, 5, 20)

theta, omega = np.meshgrid(theta_values, omega_values)

dtheta_dt = omega
domega_dt = -gL * np.sin(theta)

plt.figure(figsize=(10, 6))
plt.quiver(theta, omega, dtheta_dt, domega_dt, color="r")
plt.xlabel(r"$\theta$", fontsize=16)
plt.ylabel(r"$\omega$", fontsize=16)
plt.title("å˜æŒ¯ã‚Šå­ã®ãƒ™ã‚¯ãƒˆãƒ«å ´", fontsize=19)
plt.grid(True)
plt.show()
```

:::

![](/images/dynamic-bunki/1.png)

å›³ã‚’è¦‹æ˜“ãã™ã‚‹ãŸã‚ã«ã€å„ãƒ™ã‚¯ãƒˆãƒ«ã‚’ã™ã¹ã¦åŒã˜é•·ã•ã«ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib

gL = 1.0

theta_values = np.linspace(-2 * np.pi, 2 * np.pi, 20)
omega_values = np.linspace(-5, 5, 20)

theta, omega = np.meshgrid(theta_values, omega_values)

dtheta_dt = omega
domega_dt = -gL * np.sin(theta)

magnitude = np.sqrt(dtheta_dt**2 + domega_dt**2)
dtheta_dt_normalized = dtheta_dt / magnitude
domega_dt_normalized = domega_dt / magnitude

plt.figure(figsize=(10, 6))
plt.quiver(
    theta, omega, dtheta_dt_normalized, domega_dt_normalized, color="r", scale=40
)
plt.xlabel(r"$\theta$", fontsize=16)
plt.ylabel(r"$\omega$", fontsize=16)
plt.title("å˜æŒ¯ã‚Šå­ã®ãƒ™ã‚¯ãƒˆãƒ«å ´", fontsize=19)
plt.grid(True)
plt.show()
```

:::

![](/images/dynamic-bunki/2.png)

å¾®åˆ†æ–¹ç¨‹å¼ã®è§£æ›²ç·šã‚’ã€æ™‚é–“ã®å‘ãã‚‚è€ƒæ…®ã—ã¦ **è»Œé“ (orbit)** ã¨å‘¼ã¶ã€‚å¹³é¢ä¸Šã«åˆæœŸå€¤ã‚’ãŸãã•ã‚“å–ã£ã¦è¨ˆç®—ã™ã‚‹ã“ã¨ã§ã€**æµã‚Œ (flow)** ã‚’æã‘ã‚‹ã€‚ã“ã‚Œã‚’Pythonã§æãã¨æ¬¡ã®é€šã‚Šã§ã‚ã‚‹ã€‚$\theta$, $\omega$ ãŒåŸç‚¹ã«è¿‘ã„ã¨ã“ã‚ã§ã¯æ¥•å††å½¢ã«ãªã£ã¦ã„ã¦ã€å‘¨æœŸçš„ã«æŒ¯å‹•ã—ã¦ã„ã‚‹ã“ã¨ãŒè¦‹ã¦å–ã‚Œã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib
from scipy.integrate import solve_ivp


def pendulum(t, y):
    gL = 1.0
    theta, omega = y
    dydt = [omega, -gL * np.sin(theta)]
    return dydt


t_span = (0, 100)
t_eval = np.linspace(t_span[0], t_span[1], 1000)

# åˆæœŸå€¤
np.random.seed(28)
num_initial_conditions = 200
initial_conditions_list = np.random.uniform(-5, 5, (num_initial_conditions, 2))


plt.figure(figsize=(10, 6))

for initial_conditions in initial_conditions_list:
    sol = solve_ivp(pendulum, t_span, initial_conditions, t_eval=t_eval)
    plt.plot(
        sol.y[0],
        sol.y[1],
    )

plt.grid(True)
plt.xlim(-5, 5)
plt.ylim(-5, 5)
plt.xlabel(r"$\theta$", fontsize=16)
plt.ylabel(r"$\omega$", fontsize=16)
plt.title("å˜æŒ¯ã‚Šå­ã®æµã‚Œ", fontsize=19)
plt.grid(True)
plt.show()
```

:::

![](/images/dynamic-bunki/3.png)

è³ªç‚¹ã®é€Ÿã• $l\dot{\theta}$ ã«æ¯”ä¾‹ã—ãŸæŠµæŠ—åŠ›ï¼ˆç²˜æ€§æŠµæŠ—ï¼‰ã‚’è¿½åŠ ã™ã‚‹ï¼ˆ$c$ï¼šæ¯”ä¾‹å®šæ•°ï¼‰ã€‚

$$
\begin{equation*}
\begin{cases}
\dot{\theta} = \omega \\
\dot{\omega} = -\frac{g}{l} \sin\theta - \frac{c}{m} \omega
\end{cases}
\end{equation*}
$$

$g/l=1$, $c/m=1$ ã¨ã—ã¦ã€åŒæ§˜ã«ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨æµã‚Œã‚’Pythonã§æç”»ã—ãŸã€‚æŒ™å‹•ã¯æŠµæŠ—åŠ›ãªã—ã¨æ¯”ã¹ã‚‹ã¨å¤‰åŒ–ã—ã¦ã„ã‚‹ã“ã¨ãŒä¸€ç™ºã§ã‚ã‹ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib

gL = 1.0
cm = 0.5

theta_values = np.linspace(-2 * np.pi, 2 * np.pi, 20)
omega_values = np.linspace(-5, 5, 20)

theta, omega = np.meshgrid(theta_values, omega_values)

dtheta_dt = omega
domega_dt = -gL * np.sin(theta) - cm * omega

magnitude = np.sqrt(dtheta_dt**2 + domega_dt**2)
dtheta_dt_normalized = dtheta_dt / magnitude
domega_dt_normalized = domega_dt / magnitude

plt.figure(figsize=(10, 6))
plt.quiver(
    theta, omega, dtheta_dt_normalized, domega_dt_normalized, color="r", scale=40
)
plt.xlabel(r"$\theta$", fontsize=16)
plt.ylabel(r"$\omega$", fontsize=16)
plt.title("å˜æŒ¯ã‚Šå­ã®ãƒ™ã‚¯ãƒˆãƒ«å ´ï¼ˆç²˜æ€§æŠµæŠ—ï¼‰", fontsize=19)
plt.grid(True)
plt.show()
```

```python
import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib
from scipy.integrate import solve_ivp


def pendulum(t, y):
    gL = 1.0
    cm = 0.5
    theta, omega = y
    dydt = [omega, -gL * np.sin(theta) - cm * omega]
    return dydt


t_span = (0, 100)
t_eval = np.linspace(t_span[0], t_span[1], 1000)

# åˆæœŸå€¤
np.random.seed(28)
num_initial_conditions = 100
initial_conditions_list = np.random.uniform(-4, 4, (num_initial_conditions, 2))


plt.figure(figsize=(10, 6))

for initial_conditions in initial_conditions_list:
    sol = solve_ivp(pendulum, t_span, initial_conditions, t_eval=t_eval)
    plt.plot(
        sol.y[0],
        sol.y[1],
    )

plt.grid(True)
plt.xlabel(r"$\theta$", fontsize=16)
plt.ylabel(r"$\omega$", fontsize=16)
plt.title("å˜æŒ¯ã‚Šå­ã®æµã‚Œï¼ˆç²˜æ€§æŠµæŠ—ï¼‰", fontsize=19)
plt.grid(True)
plt.show()
```

:::

![](/images/dynamic-bunki/4.png)
![](/images/dynamic-bunki/5.png)

æ¬¡ã¯æŒ¯ã‚Šå­ã®å°ãŒ $x$ æ–¹å‘ã« $x_1 = B \sin \Omega t$ ã§æŒ¯å‹•ã—ã¦ã„ã‚‹ã¨ã™ã‚‹ã€‚ã¤ã¾ã‚Šã€ä½ç½®ãƒ™ã‚¯ãƒˆãƒ« $\vec{r}$ ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

$$
\vec{r} = (l \sin \theta + B \sin \Omega t, -l \sin \theta)
$$

ã“ã®ã¨ãã€é‹å‹•æ–¹ç¨‹å¼ã‹ã‚‰å¾®åˆ†æ–¹ç¨‹å¼ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã‚ã‚‹ã€‚

$$
\begin{equation*}
\begin{cases}
\dot{\theta} = \omega \\
\dot{\omega} = -\frac{g}{l} \sin\theta - \frac{c}{m} \omega + \frac{B\Omega^2}{l} \sin \Omega t \cos \theta
\end{cases}
\end{equation*}
$$

ã“ã®ã‚ˆã†ã«å³è¾ºã«æ™‚é–“ $t$ ã‚’é™½ã«å«ã‚“ã§ã„ã‚‹å¾®åˆ†æ–¹ç¨‹å¼ã‚’**éè‡ªå¾‹ç³»**ã¨ã„ã†ã€‚ã¾ãŸã€æ™‚é–“ $t$ ã‚’é™½ã«å«ã‚“ã§ã„ãªã„å¾®åˆ†æ–¹ç¨‹å¼ã‚’**è‡ªå¾‹ç³»**ã¨ã„ã†ã€‚éè‡ªå¾‹ç³»ã«å¯¾ã—ã¦ã¯ã€$(t,\theta,\omega)$-ç©ºé–“ï¼ˆ**æ‹¡å¤§ç›¸ç©ºé–“**ï¼‰ã‚’è€ƒãˆã€ç©ºé–“ã®å„ç‚¹ $(t,\theta,\omega)$ ã«ãƒ™ã‚¯ãƒˆãƒ«

$$
\left(1, \dot{\theta}, \dot{\omega} \right) = \left( 1, \omega, -\frac{g}{l} \sin\theta - \frac{c}{m} \omega + \frac{B\Omega^2}{l} \sin \Omega t \right)
$$

ã‚’å¯¾å¿œã•ã›ã‚‹å†™åƒã‚’è€ƒãˆã‚‹ã€‚ã“ã‚Œã‚’æ‹¡å¤§ç›¸ç©ºé–“ã«ãŠã‘ã‚‹ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨ã„ã„ã€åŒæ§˜ã«æµã‚Œã‚‚å®šã¾ã‚‹ã€‚

$g/l=1.0$, $c/m=0.3$, $B/l=1.1$, $\Omega=1.0$ ã¨ã—ãŸã¨ãã®è»Œé“ã‚’è¨ˆç®—ã™ã‚‹ã€‚åˆæœŸå€¤ã¯ $(t,\theta,\omega)=(0,0,0)$ ã§ã‚ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp


def pendulum(t, y):
    gL = 1.0
    cm = 0.3
    Omega = 1.0
    Bl = 1.1
    theta, omega = y
    dydt = [
        omega,
        -gL * np.sin(theta)
        - cm * omega
        + (Bl * Omega**2) * np.sin(Omega * t) * np.cos(theta),
    ]
    return dydt


t_span = (0, 200)
t_eval = np.linspace(t_span[0], t_span[1], 10000)

initial_conditions = [0.0, 0.0]

sol = solve_ivp(
    pendulum,
    t_span,
    initial_conditions,
    t_eval=t_eval,
)

fig = plt.figure(figsize=(12, 8))
ax = fig.add_subplot(111, projection="3d")

ax.plot(sol.t[:3000], sol.y[0][:3000], sol.y[1][:3000])

ax.set_xlabel("t", fontsize=16)
ax.set_ylabel(r"$\theta$", fontsize=16)
ax.set_zlabel(r"$\omega$", fontsize=16)
plt.show()
```

:::

![](/images/dynamic-bunki/6.png)

ååˆ†æ™‚é–“ãŒçµŒéã—ãŸã‚ã¨ã®è»Œé“ã‚’ $(\theta,\omega)$-å¹³é¢ã«å°„å½±ã™ã‚‹ã€‚è»Œé“ã¯1å›å·»ãã®æ¥•å††ä¸Šã‚’å›ã‚‹å‘¨å›è»Œé“ã«åæŸã—ã¦ã„ã‚‹ã“ã¨ãŒè¦‹ã¦å–ã‚Œã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
plt.figure(figsize=(10, 6))
plt.plot(sol.y[0][5000:], sol.y[1][5000:])
plt.xlabel(r"$\theta$", fontsize=16)
plt.ylabel(r"$\omega$", fontsize=16)
plt.title(r"$B/l = 1.1$", fontsize=19)
plt.grid(True)

plt.show()
```
:::

![](/images/dynamic-bunki/7.png)

$B/l=1.42$ ã¨ã—ãŸã¨ãã®è»Œé“ã‚’è¨ˆç®—ã™ã‚‹ã€‚ã•ãã»ã©ã¨å¤‰ã‚ã£ã¦ã€2å›å·»ãã®æ¥•å††ä¸Šã‚’å›ã‚‹å‘¨å›è»Œé“ã«åæŸã—ã¦ã„ã‚‹ã€‚ãªãŠã€ä½•ã‹ã—ã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€ã‚‚ã¡ã‚ã‚“è»Œé“ãŒåæŸã™ã‚‹ã¾ã§ã®æ™‚é–“ã‚„å¿…è¦ãªç²¾åº¦ãŒå¤§ããå¤‰ã‚ã£ã¦ãã‚‹ãŸã‚ã€å¿…è¦ã«å¿œã˜ã¦ã•ãã»ã©ã®ã‚ˆã†ãª3æ¬¡å…ƒãƒ—ãƒ­ãƒƒãƒˆã‚’è¦‹ãªãŒã‚‰å°„å½±ã™ã‚‹ã¨ä¾¿åˆ©ã§ã‚ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp


def pendulum(t, y):
    gL = 1.0
    cm = 0.3
    Omega = 1.0
    Bl = 1.42
    theta, omega = y
    dydt = [
        omega,
        -gL * np.sin(theta)
        - cm * omega
        + (Bl * Omega**2) * np.sin(Omega * t) * np.cos(theta),
    ]
    return dydt


t_span = (0, 1000)
t_eval = np.linspace(t_span[0], t_span[1], 500000)

initial_conditions = [0.0, 0.0]

sol = solve_ivp(
    pendulum,
    t_span,
    initial_conditions,
    t_eval=t_eval,
)

plt.figure(figsize=(10, 6))
plt.plot(sol.y[0][-10000:], sol.y[1][-10000:])
plt.xlabel(r"$\theta$", fontsize=16)
plt.ylabel(r"$\omega$", fontsize=16)
plt.title(r"$B/l = 1.42$", fontsize=19)
plt.grid(True)

plt.show()
```
:::

![](/images/dynamic-bunki/8.png)

ã•ã‚‰ã« $B/l=1.443$ ã§è¨ˆç®—ã™ã‚‹ã¨ã€éå‘¨æœŸè»Œé“ã¨ãªã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp


def pendulum(t, y):
    gL = 1.0
    cm = 0.3
    Omega = 1.0
    Bl = 1.443
    theta, omega = y
    dydt = [
        omega,
        -gL * np.sin(theta)
        - cm * omega
        + (Bl * Omega**2) * np.sin(Omega * t) * np.cos(theta),
    ]
    return dydt


t_span = (0, 1000)
t_eval = np.linspace(t_span[0], t_span[1], 500000)

initial_conditions = [0.0, 0.0]

sol = solve_ivp(
    pendulum,
    t_span,
    initial_conditions,
    t_eval=t_eval,
)

plt.figure(figsize=(10, 6))
plt.plot(sol.y[0][-40000:], sol.y[1][-40000:])
plt.xlabel(r"$\theta$", fontsize=16)
plt.ylabel(r"$\omega$", fontsize=16)
plt.title(r"$B/l = 1.443$", fontsize=19)
plt.grid(True)

plt.show()
```
:::

![](/images/dynamic-bunki/9.png)

ã“ã®ã‚ˆã†ã«ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å¤‰åŒ–ã«ã¨ã‚‚ãªã„ã€ã‚·ã‚¹ãƒ†ãƒ ãŒè³ªçš„ã«å¤‰åŒ–ã™ã‚‹ã“ã¨ã‚’**åˆ†å²**ã¨ã„ã†ã€‚åŠ›å­¦ç³»ã§ã¯åˆ†å²ã®æŒ¯ã‚‹èˆã„ã‚’èª¿ã¹ã‚‹ã“ã¨ãŒé‡è¦ãªãƒ†ãƒ¼ãƒã®1ã¤ã§ã‚ã‚‹ã€‚

## 2. ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´

åŠ›å­¦ç³»ã§ã¯ä¸»ã«éç·šå½¢åŠ›å­¦ç³»ã‚’å¯¾è±¡ã¨ã™ã‚‹ã€‚éç·šå½¢åŠ›å­¦ç³»ã‚’è§£æã™ã‚‹ã¨ãã€ç·šå½¢åŠ›å­¦ç³»ã«è¿‘ä¼¼ã™ã‚‹ã“ã¨ã§ç·šå½¢ä»£æ•°ã®å¼·åŠ›ãªæ©æµã‚’å—ã‘ã‚‰ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã€‚ãã“ã§ã€ã“ã“ã§ã¯ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æ€§è³ªã«ã¤ã„ã¦ç´¹ä»‹ã™ã‚‹ã€‚

ä¸€èˆ¬ã«ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã‚‹ã€‚

$A$ ã‚’ $n$ æ¬¡æ­£æ–¹è¡Œåˆ—ã¨ã™ã‚‹ã€‚

$$
\dot{\vec{x}} = A \vec{x}, \quad \vec{x} \in \mathbb{R}^n
$$

ã§å®šç¾©ã•ã‚Œã‚‹ $\mathbb{R}^n$ ä¸Šã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã‚’**ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´**ã¨ã„ã†ã€‚

### 1æ¬¡å…ƒç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´

1æ¬¡å…ƒç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¯ã€$a$ ã‚’å®Ÿå®šæ•°ã¨ã—ã¦

$$
\dot{x} = ax, \quad x \in \mathbb{R}
$$

ã§å®šç¾©ã•ã‚Œã‚‹ã€‚$t=0$ ã®ã¨ãã€$x=x_0$ ã‚’é€šã‚‹è»Œé“ã¯

$$
x(t) = e^{at}x_0
$$

ã§ã‚ã‚‹ã€‚å®šæ•° $a$ ã®ç¬¦å·ã«ã‚ˆã£ã¦ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æ§˜å­ãŒå¤‰åŒ–ã™ã‚‹ã€‚

- $a>0$ï¼šåŸç‚¹ $O$ ä»¥å¤–ã®ç‚¹ã¯æ™‚é–“ç™ºå±•ã¨ã¨ã‚‚ã«åŸç‚¹ã‹ã‚‰é ã–ã‹ã‚‹ã€‚
- $a=0$ï¼šã™ã¹ã¦ã®ç‚¹ãŒä¸å‹•ã€‚
- $a<0$ï¼šåŸç‚¹ $O$ ä»¥å¤–ã®ã™ã¹ã¦ã®ç‚¹ã¯æ™‚é–“ç™ºå±•ã¨ã¨ã‚‚ã«åŸç‚¹ã«é™ã‚Šãªãè¿‘ã¥ãã€‚

è¦‹æ–¹ã‚’å¤‰ãˆã‚‹ã¨ã€å®šæ•° $a$ ã¯ $1\times1$ è¡Œåˆ—ã§ãã®å›ºæœ‰å€¤ã¨è€ƒãˆã‚‰ã‚Œã‚‹ã€‚ã¤ã¾ã‚Šã€ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æŒ™å‹•ã¯å›ºæœ‰å€¤ã®ç¬¦å·ãŒé‡è¦ã«ãªã‚‹ã“ã¨ãŒäºˆæƒ³ã§ãã‚‹ã€‚

å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãŠã‘ã‚‹Pythonã§ã®æç”»ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã‚ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import numpy as np
import matplotlib.pyplot as plt

t = np.linspace(-2, 2, 400)

initial_conditions = [
    0.5,
    1.0,
    1.5,
    2.0,
    0.0,
    -0.5,
    -1.0,
    -1.5,
    -2.0,
]

plt.figure(figsize=(6, 6))

for x0 in initial_conditions:
    x_t = x0 * np.exp(t)
    (line,) = plt.plot(t, x_t)
    color = line.get_color()
    for i in range(0, len(t) - 1, 50):
        plt.arrow(
            t[i],
            x_t[i],
            t[i + 1] - t[i],
            x_t[i + 1] - x_t[i],
            shape="full",
            lw=0,
            length_includes_head=True,
            head_width=0.1,
            color=color,
        )


plt.title(r"$x(t) = e^t x_0$", fontsize=19)
plt.xlabel("t", fontsize=16)
plt.ylabel("x", fontsize=16)
plt.grid(True)

plt.xlim(-2, 2)
plt.ylim(-2, 2)

plt.show()
```

```python
import numpy as np
import matplotlib.pyplot as plt

t = np.linspace(-2, 2, 400)

initial_conditions = [
    0.5,
    1.0,
    1.5,
    0.0,
    -0.5,
    -1.0,
    -1.5,
]

plt.figure(figsize=(6, 6))

for x0 in initial_conditions:
    x_t = [x0 for _ in range(len(t))]
    (line,) = plt.plot(t, x_t)
    color = line.get_color()
    for i in range(0, len(t) - 1, 50):
        plt.arrow(
            t[i],
            x_t[i],
            t[i + 1] - t[i],
            x_t[i + 1] - x_t[i],
            shape="full",
            lw=0,
            length_includes_head=True,
            head_width=0.1,
            color=color,
        )


plt.title(r"$x(t) = x_0$", fontsize=19)
plt.xlabel("t", fontsize=16)
plt.ylabel("x", fontsize=16)
plt.grid(True)

plt.xlim(-2, 2)
plt.ylim(-2, 2)

plt.show()
```

```python
import numpy as np
import matplotlib.pyplot as plt

t = np.linspace(-2, 2, 400)

initial_conditions = [
    0.5,
    1.0,
    1.5,
    2.0,
    0.0,
    -0.5,
    -1.0,
    -1.5,
    -2.0,
]

plt.figure(figsize=(6, 6))

for x0 in initial_conditions:
    x_t = x0 * np.exp(-t)
    (line,) = plt.plot(t, x_t)
    color = line.get_color()
    for i in range(0, len(t) - 1, 50):
        plt.arrow(
            t[i],
            x_t[i],
            t[i + 1] - t[i],
            x_t[i + 1] - x_t[i],
            shape="full",
            lw=0,
            length_includes_head=True,
            head_width=0.1,
            color=color,
        )


plt.title(r"$x(t) = e^{-t} x_0$", fontsize=19)
plt.xlabel("t", fontsize=16)
plt.ylabel("x", fontsize=16)
plt.grid(True)

plt.xlim(-2, 2)
plt.ylim(-2, 2)

plt.show()
```
:::

![](/images/dynamic-bunki/10.png)
![](/images/dynamic-bunki/11.png)
![](/images/dynamic-bunki/12.png)

### 2æ¬¡å…ƒç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´

2æ¬¡å…ƒç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¯

$$
A = \begin{pmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{pmatrix}
$$

ã¨ã—ã¦æ¬¡ã®å¼ã§å®šç¾©ã•ã‚Œã‚‹ã€‚

$$
\dot{\vec{x}} = A \vec{x}, \quad \vec{x} = \begin{pmatrix} x \\ y \end{pmatrix} \in \mathbb{R}^2
$$

2æ¬¡æ­£æ–¹è¡Œåˆ— $A$ ã®å›ºæœ‰æ–¹ç¨‹å¼ã¯2æ¬¡æ–¹ç¨‹å¼ãªã®ã§ã€ä»¥ä¸‹ã®3ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆ†ã‹ã‚Œã‚‹ã€‚

1. å›ºæœ‰æ–¹ç¨‹å¼ã¯ç›¸ç•°ãªã‚‹2ã¤ã®å®Ÿæ ¹ã‚’ã‚‚ã¤
2. å›ºæœ‰æ–¹ç¨‹å¼ã¯1ã¤ã®é‡æ ¹ã‚’ã‚‚ã¤
3. å›ºæœ‰æ–¹ç¨‹å¼ã¯è¤‡ç´ å…±å½¹ãª2ã¤ã®è™šæ ¹ã‚’ã‚‚ã¤

#### ç›¸ç•°ãªã‚‹2ã¤ã®å®Ÿæ ¹ã‚’ã‚‚ã¤å ´åˆ

å›ºæœ‰æ–¹ç¨‹å¼ã®ç›¸ç•°ãªã‚‹2ã¤ã®å®Ÿæ ¹ã‚’ $a, b$ï¼ˆ$a < b$ï¼‰ã¨ã™ã‚‹ã€‚$a,b$ ã«å¯¾ã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’ãã‚Œãã‚Œ $\vec{p}, \vec{q}$ ã¨ã™ã‚‹ã¨ã€$a \ne b$ ã‚ˆã‚Š $A$ ã¯ $P=(\vec{p},\vec{q})$ ã§å¯¾è§’åŒ–ã§ãã‚‹ã€‚

$$
P^{-1} A P = \begin{pmatrix} a & 0 \\ 0 & b \end{pmatrix}
$$

$\vec{x}$ ã«å¯¾ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªåº§æ¨™å¤‰æ›ã‚’è€ƒãˆã‚‹ã€‚

$$
\vec{x} = P \vec{u}, \quad \vec{u} = \begin{pmatrix} u \\ v \end{pmatrix} \in \mathbb{R}^2
$$

$\vec{u}$-å¹³é¢ä¸Šã§ã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æ§˜å­ã‚’èª¿ã¹ã‚‹ã€‚

$$
\begin{align*}
&\dot{\vec{u}} = P^{-1} \dot{\vec{x}} = P^{-1} A \vec{x} = P^{-1} A P \vec{u} = \begin{pmatrix} a & 0 \\ 0 & b \end{pmatrix} \vec{u} \\
&\begin{cases}
\dot{u} = au \\
\dot{v} = bv
\end{cases}
\end{align*}
$$

$t=0$ ã®ã¨ãã€$(u,v) = (u_0, v_0)$ ã‚’é€šã‚‹è»Œé“ã¯

$$
\begin{cases}
u(t) = e^{at} u_0 \\
v(t) = e^{bt} v_0
\end{cases}
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚ãã‚Œãã‚Œ1æ¬¡å…ƒç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨åŒã˜ãªã®ã§ã€ã“ã®å ´åˆã® $\vec{u}$-å¹³é¢ã«ãŠã‘ã‚‹2æ¬¡å…ƒç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æŒ™å‹•ã¯ãã‚Œãã‚Œã®åˆæˆã§ã‚ã‚‹ã€‚ã¾ãŸã€$x$-å¹³é¢ä¸Šã®æµã‚Œã¯ $\vec{x} = P \vec{u}$ ã¨å¤‰æ›ã™ã‚Œã°ã‚ˆã„ã€‚

å›ºæœ‰å€¤ $(a,b) = (-1, -0.5), (-1, 0.5)$ ã®å ´åˆã®æµã‚Œã¯æ¬¡ã®é€šã‚Šã§ã‚ã‚‹ã€‚çŸ¢å°ã¯æ™‚é–“ã®å‘ãã‚’æŒ‡ã™ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import numpy as np
import matplotlib.pyplot as plt

t = np.linspace(0, 10, 400)

a = -1.0
b = -0.5

initial_conditions = [
    (0.5, 1.0),
    (1.0, 0.5),
    (1.5, 2.0),
    (-0.5, -1.0),
    (-1.0, -0.5),
    (-1.5, -2.0),
    (0.5, -1.0),
    (1.0, -0.5),
    (1.5, -2.0),
    (-0.5, 1.0),
    (-1.0, 0.5),
    (-1.5, 2.0),
    (0.0, 1.0),
    (0.0, -1.0),
    (1.0, 0.0),
    (-1.0, 0.0),
]
plt.figure(figsize=(6, 6))

for u0, v0 in initial_conditions:
    u_t = u0 * np.exp(a * t)
    v_t = v0 * np.exp(b * t)
    plt.plot(u_t, v_t, color="black")
    i = 20
    plt.arrow(
        u_t[i],
        v_t[i],
        u_t[i + 1] - u_t[i],
        v_t[i + 1] - v_t[i],
        shape="full",
        lw=0,
        length_includes_head=True,
        head_width=0.06,
        color="black",
    )

plt.title(r"$u(t) = e^{-t} u_0$ and $v(t) = e^{-0.5t} v_0$", fontsize=19)
plt.xlabel("u", fontsize=16)
plt.ylabel("v", fontsize=16)
plt.grid(True)

plt.xlim(-1, 1)
plt.ylim(-1, 1)

plt.show()
```

```python
import numpy as np
import matplotlib.pyplot as plt

t = np.linspace(0, 10, 400)

a = -1.0
b = 0.5

initial_conditions = [
    (-1.0, 0.5),
    (1.0, 0.5),
    (-1.0, -0.5),
    (1.0, -0.5),
    (-1.0, 0.25),
    (1.0, 0.25),
    (-1.0, -0.25),
    (1.0, -0.25),
    (-1.0, 0.1),
    (1.0, 0.1),
    (-1.0, -0.1),
    (1.0, -0.1),
    (0.0, 0.01),
    (0.0, -0.01),
    (1.0, 0.0),
    (-1.0, 0.0),
]
plt.figure(figsize=(6, 6))

for u0, v0 in initial_conditions:
    u_t = u0 * np.exp(a * t)
    v_t = v0 * np.exp(b * t)
    plt.plot(u_t, v_t, color="black")
    if (u0, v0) == (1.0, 0.0) or (u0, v0) == (-1.0, 0.0):
        i = 40
    elif (u0, v0) == (0.0, 0.01) or (u0, v0) == (0.0, -0.01):
        i = 300
    else:
        i = 50
    plt.arrow(
        u_t[i],
        v_t[i],
        u_t[i + 1] - u_t[i],
        v_t[i + 1] - v_t[i],
        shape="full",
        lw=0,
        length_includes_head=True,
        head_width=0.06,
        color="black",
    )

plt.title(r"$u(t) = e^{-t} u_0$ and $v(t) = e^{0.5t} v_0$", fontsize=19)
plt.xlabel("u", fontsize=16)
plt.ylabel("v", fontsize=16)
plt.grid(True)

plt.xlim(-1, 1)
plt.ylim(-1, 1)

plt.show()
```
:::

![](/images/dynamic-bunki/13.png)
![](/images/dynamic-bunki/14.png)

#### 1ã¤ã®é‡æ ¹ã‚’ã‚‚ã¤å ´åˆ

å›ºæœ‰æ–¹ç¨‹å¼ã®é‡æ ¹ã‚’ $a$ ã¨ã™ã‚‹ã€‚ã“ã®ã¨ãã€$\text{rank}(aI - A)$ ã¯ $0$ ã‹ $1$ ã§ã‚ã‚‹ã€‚

##### rankãŒ0ã®ã¨ã

$$
A = aI = \begin{pmatrix} a & 0 \\ 0 & a \end{pmatrix}
$$

$t=0$ ã®ã¨ãã€$(u,v) = (u_0, v_0)$ ã‚’é€šã‚‹è»Œé“ã¯

$$
\begin{cases}
u(t) = e^{at} u_0 \\
v(t) = e^{at} v_0
\end{cases}
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚å›ºæœ‰å€¤ $a = -1$ ã®å ´åˆã®æµã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ï¼ˆ$a = 1$ ã¯çŸ¢å°ã®å‘ããŒå¤‰ã‚ã‚‹ã ã‘ï¼‰ã€‚

:::details Pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import numpy as np
import matplotlib.pyplot as plt

t = np.linspace(0, 10, 400)

a = -1.0

initial_conditions = [
    (0.5, 1.0),
    (1.0, 0.5),
    (1.5, 2.0),
    (-0.5, -1.0),
    (-1.0, -0.5),
    (-1.5, -2.0),
    (0.5, -1.0),
    (1.0, -0.5),
    (1.5, -2.0),
    (-0.5, 1.0),
    (-1.0, 0.5),
    (-1.5, 2.0),
    (0.0, 1.0),
    (0.0, -1.0),
    (1.0, 0.0),
    (-1.0, 0.0),
]
plt.figure(figsize=(6, 6))

for u0, v0 in initial_conditions:
    u_t = u0 * np.exp(a * t)
    v_t = v0 * np.exp(a * t)
    plt.plot(u_t, v_t, color="black")
    i = 20
    plt.arrow(
        u_t[i],
        v_t[i],
        u_t[i + 1] - u_t[i],
        v_t[i + 1] - v_t[i],
        shape="full",
        lw=0,
        length_includes_head=True,
        head_width=0.06,
        color="black",
    )

plt.title(r"$u(t) = e^{-t} u_0$ and $v(t) = e^{-t} v_0$", fontsize=19)
plt.xlabel("u", fontsize=16)
plt.ylabel("v", fontsize=16)
plt.grid(True)

plt.xlim(-1, 1)
plt.ylim(-1, 1)

plt.show()
```
:::

![](/images/dynamic-bunki/15.png)

##### rankãŒ1ã®ã¨ã

$A$ ã®ã‚¸ãƒ§ãƒ«ãƒ€ãƒ³æ¨™æº–å½¢ã‚’æ±‚ã‚ã‚‹ã€‚å›ºæœ‰å€¤ $a$ ã«å¯¾ã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’ $\vec{p} \in \mathbb{R}^2$ ã¨ã™ã‚‹ã€‚ã¾ãŸã€$(A - aI)\vec{q} = \vec{p}$ ã¨ãªã‚‹ $\vec{q} \in \mathbb{R}^2$ ã‚’æ±‚ã‚ã‚‹ã¨ã€$\vec{p}, \vec{q}$ ã¯1æ¬¡ç‹¬ç«‹ã§ã‚ã‚‹ã€‚$P = (\vec{p}, \vec{q})$ ã¨ãŠãã¨ã€

$$
\begin{align*}
&\begin{cases}
A \vec{p} = a \vec{p} \\
A \vec{q} = \vec{p} + a \vec{q}
\end{cases}\\
&A(\vec{p}, \vec{q}) = (\vec{p}, \vec{q}) \begin{pmatrix} a & 1 \\ 0 & a \end{pmatrix} \\
& P^{-1} A P = \begin{pmatrix} a & 1 \\ 0 & a \end{pmatrix} 
\end{align*}
$$

$\vec{x}$ ã«å¯¾ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªåº§æ¨™å¤‰æ›ã‚’è€ƒãˆã‚‹ã€‚

$$
\vec{x} = P \vec{u}, \quad \vec{u} = \begin{pmatrix} u \\ v \end{pmatrix} \in \mathbb{R}^2
$$

$\vec{u}$-å¹³é¢ä¸Šã§ã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æ§˜å­ã‚’èª¿ã¹ã‚‹ã€‚

$$
\begin{align*}
&\dot{\vec{u}} = P^{-1} \dot{\vec{x}} = P^{-1} A \vec{x} = P^{-1} A P \vec{u} = \begin{pmatrix} a & 1 \\ 0 & a \end{pmatrix} \vec{u} \\
&\begin{cases}
\dot{u} = au + v\\
\dot{v} = av
\end{cases}
\end{align*}
$$

$t=0$ ã®ã¨ãã€$(u,v) = (u_0, v_0)$ ã‚’é€šã‚‹è»Œé“ã¯

$$
\begin{cases}
u(t) = e^{at} (u_0 + t v_0) \\
v(t) = e^{at} v_0
\end{cases}
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚å›ºæœ‰å€¤ $a = -1$ ã®å ´åˆã®æµã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ï¼ˆ$a = 1$ ã¯çŸ¢å°ã®å‘ããŒå¤‰ã‚ã‚‹ã ã‘ï¼‰ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import numpy as np
import matplotlib.pyplot as plt

t = np.linspace(0, 10, 400)

a = -1.0

initial_conditions = [
    (0.5, 1.0),
    (1.0, 0.5),
    (1.5, 2.0),
    (-0.5, -1.0),
    (-1.0, -0.5),
    (-1.5, -2.0),
    (0.5, -1.0),
    (1.0, -0.5),
    (1.5, -2.0),
    (-0.5, 1.0),
    (-1.0, 0.5),
    (-1.5, 2.0),
    (0.0, 1.0),
    (0.0, -1.0),
    (1.0, 0.0),
    (-1.0, 0.0),
]
plt.figure(figsize=(6, 6))

for u0, v0 in initial_conditions:
    u_t = (np.array([u0 for _ in range(len(t))]) + t * v0) * np.exp(a * t)
    v_t = v0 * np.exp(a * t)
    plt.plot(u_t, v_t, color="black")
    i = 20
    plt.arrow(
        u_t[i],
        v_t[i],
        u_t[i + 1] - u_t[i],
        v_t[i + 1] - v_t[i],
        shape="full",
        lw=0,
        length_includes_head=True,
        head_width=0.06,
        color="black",
    )

plt.title(r"$u(t) = e^{-t} (u_0 + t v_0)$ and $v(t) = e^{-t} v_0$", fontsize=19)
plt.xlabel("u", fontsize=16)
plt.ylabel("v", fontsize=16)
plt.grid(True)

plt.xlim(-1, 1)
plt.ylim(-1, 1)

plt.show()
```
:::

![](/images/dynamic-bunki/16.png)

#### è¤‡ç´ å…±å½¹ãª2ã¤ã®è™šæ ¹ã‚’ã‚‚ã¤å ´åˆ

å›ºæœ‰æ–¹ç¨‹å¼ã®è¤‡ç´ å…±å½¹ãª2ã¤ã®è™šæ ¹ã‚’ $a + ib$, $a - ib$, $b>0$ ã¨ã™ã‚‹ã€‚$a + ib$ ã«å¯¾ã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’ $\vec{z} \in \mathbb{C}^2$ ã¨ã—ã¦ã€ãã®å®Ÿéƒ¨ãƒ»è™šéƒ¨ã‚’ãã‚Œãã‚Œ $\vec{p}$, $\vec{q} \in \mathbb{R}^2$ ã¨ã™ã‚‹ã€‚

$$
\vec{z} = \vec{p} + i \vec{q}
$$

ã“ã®ã¨ãã€$\vec{p}$ ã¨ $\vec{q}$ ã¯1æ¬¡ç‹¬ç«‹ã¨ãªã‚‹ã€‚$P = (\vec{p}, \vec{q})$ ã¨ãŠãã¨

$$
\begin{align*}
&A\vec{z} = (a + ib) \vec{z} \\
&A\vec{p} + i A\vec{q} \\
&\begin{cases}
A\vec{p} = a \vec{p} - b \vec{q} \\
A\vec{q} = b \vec{p} + a \vec{q}
\end{cases}\\
&A(\vec{p}, \vec{q}) = (\vec{p}, \vec{q}) \begin{pmatrix} a & b \\ -b & a \end{pmatrix} \\
&P^{-1} A P = \begin{pmatrix} a & b \\ -b & a \end{pmatrix}
\end{align*}
$$

$\vec{x}$ ã«å¯¾ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªåº§æ¨™å¤‰æ›ã‚’è€ƒãˆã‚‹ã€‚

$$
\vec{x} = P \vec{u}, \quad \vec{u} = \begin{pmatrix} u \\ v \end{pmatrix} \in \mathbb{R}^2
$$

$\vec{u}$-å¹³é¢ä¸Šã§ã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æ§˜å­ã‚’èª¿ã¹ã‚‹ã€‚

$$
\begin{align*}
&\dot{\vec{u}} = P^{-1} \dot{\vec{x}} = P^{-1} A \vec{x} = P^{-1} A P \vec{u} = \begin{pmatrix} a & b \\ -b & a \end{pmatrix} \vec{u} \\
&\begin{cases}
\dot{u} = au + bv\\
\dot{v} = -bu + av
\end{cases}
\end{align*}
$$

$t=0$ ã®ã¨ãã€$(u,v) = (u_0, v_0)$ ã‚’é€šã‚‹è»Œé“ã¯

$$
\begin{cases}
u(t) = e^{at} (u_0 \cos bt + v_0 \sin bt) \\
v(t) = e^{at} (v_0 \cos bt - u_0 \sin bt)
\end{cases}
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚å›ºæœ‰å€¤ $-0.1 \pm i$, $\pm i$ ã®å ´åˆã®æµã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib

t = np.linspace(0, 100, 4000)

a = -0.1
b = 1

initial_conditions = [
    (-1.0, 1.0),
]
plt.figure(figsize=(6, 6))

for u0, v0 in initial_conditions:
    u_t = (u0 * np.sin(b * t) + v0 * np.cos(b * t)) * np.exp(a * t)
    v_t = (u0 * np.cos(b * t) - v0 * np.sin(b * t)) * np.exp(a * t)
    plt.plot(u_t, v_t, color="black")
    ii = [150, 200, 300, 400, 500]
    for i in ii:
        plt.arrow(
            u_t[i],
            v_t[i],
            u_t[i + 1] - u_t[i],
            v_t[i + 1] - v_t[i],
            shape="full",
            lw=0,
            length_includes_head=True,
            head_width=0.06,
            color="black",
        )

plt.title(r"å›ºæœ‰å€¤$-0.1 \pm i$", fontsize=19)
plt.xlabel("u", fontsize=16)
plt.ylabel("v", fontsize=16)
plt.grid(True)

plt.xlim(-1, 1)
plt.ylim(-1, 1)

plt.show()
```

```python
import numpy as np
import matplotlib.pyplot as plt
import japanize_matplotlib

t = np.linspace(0, 10, 400)

a = 0.0
b = 1

initial_conditions = [
    (0.1, 0.1),
    (0.2, 0.2),
    (0.4, 0.4),
    (0.6, 0.6),
    (0.8, 0.8),
]
plt.figure(figsize=(6, 6))

for u0, v0 in initial_conditions:
    u_t = (u0 * np.sin(b * t) + v0 * np.cos(b * t)) * np.exp(a * t)
    v_t = (u0 * np.cos(b * t) - v0 * np.sin(b * t)) * np.exp(a * t)
    plt.plot(u_t, v_t, color="black")
    i = 50
    plt.arrow(
        u_t[i],
        v_t[i],
        u_t[i + 1] - u_t[i],
        v_t[i + 1] - v_t[i],
        shape="full",
        lw=0,
        length_includes_head=True,
        head_width=0.06,
        color="black",
    )

plt.title(r"å›ºæœ‰å€¤$\pm i$", fontsize=19)
plt.xlabel("u", fontsize=16)
plt.ylabel("v", fontsize=16)
plt.grid(True)

plt.xlim(-1, 1)
plt.ylim(-1, 1)

plt.show()
```
:::

![](/images/dynamic-bunki/17.png)
![](/images/dynamic-bunki/18.png)

3æ¬¡å…ƒç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã‚‚åŒæ§˜ã«å›ºæœ‰æ–¹ç¨‹å¼ã®æ ¹ã‚’åˆ†é¡ã—ã€ãã‚Œãã‚Œæ¨™æº–åŒ–ã—ã¦é€£ç«‹å¾®åˆ†æ–¹ç¨‹å¼ã‚’è§£ãã¨æ±‚ã¾ã‚‹ã€‚è©³ç´°ã¯å‚è€ƒæ–‡çŒ®ã‚’å‚ç…§ã®ã“ã¨ã€‚

## 3. é›¢æ•£æ™‚é–“åŠ›å­¦ç³»

é€£ç¶šæ™‚é–“åŠ›å­¦ç³»ãŒå¾®åˆ†æ–¹ç¨‹å¼ã§ã‚ã£ãŸã®ã«å¯¾ã—ã¦ã€é›¢æ•£æ™‚é–“åŠ›å­¦ç³»ã¯**å·®åˆ†æ–¹ç¨‹å¼**ã§è¨˜è¿°ã•ã‚Œã‚‹ã€‚ç‚¹ $\vec{x} \in \mathbb{R}^n$ ãŠã‚ˆã³é€£ç¶šå†™åƒ $f: \mathbb{R}^n \rightarrow \mathbb{R}^n$ ã«ã¤ã„ã¦ã€å·®åˆ†æ–¹ç¨‹å¼ã¯

$$
\vec{x}(t + 1) = f(\vec{x}(t)) \quad (t = 0, 1, 2, \cdots)
$$

ã§ä¸ãˆã‚‰ã‚Œã‚‹ã€‚ã“ã‚Œã‚’å˜ã«**å†™åƒ**ã¨ã„ã†ã€‚

ç‚¹ $\vec{x_0} \in \mathbb{R}^n$ ã«å¯¾ã—ã¦ã€

$$
\vec{x}_{t+1} = f(\vec{x}_t) \quad (t = 0, 1, 2, \cdots)
$$

ã§ä¸ãˆã‚‰ã‚Œã‚‹ç‚¹åˆ— $\{ \vec{x}_t : t = 0, 1, 2, \cdots \}$ ã‚’ç‚¹ $\vec{x_0}$ ã‚’é€šã‚‹**æ­£ã®åŠè»Œé“**ã¨ã„ã†ã€‚

$f$ ãŒåŒç›¸å†™åƒã§ã‚ã‚Œã°**å¯é€†ç³»**ã€ãã†ã§ãªã‘ã‚Œã°**éå¯é€†ç³»**ã¨ã„ã†ã€‚å¯é€†ç³»ã®å ´åˆã¯è² ã®æ™‚é–“æ–¹å‘ã¸ã®è»Œé“ã‚’è€ƒãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ç‚¹ $\vec{x_0} \in \mathbb{R}^n$ ã«å¯¾ã—ã¦ã€

$$
\vec{x}_{t-1} = f(\vec{x}_t) \quad (t = 0, -1, -2, \cdots)
$$

ã§ä¸ãˆã‚‰ã‚Œã‚‹ç‚¹åˆ— $\{ \vec{x}_t : t = 0, -1, -2, \cdots \}$ ã‚’æ­£ã®åŠè»Œé“ã«åŠ ãˆã¦å¾—ã‚‰ã‚Œã‚‹ç‚¹åˆ— $\{ \vec{x}_t : t = 0, \pm 1, \pm 2, \cdots \}$ ã‚’ $\vec{x_0}$ ã‚’é€šã‚‹**è»Œé“**ã¨ã„ã†ã€‚

### ç·šå½¢å†™åƒ

ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨åŒæ§˜ã«ç·šå½¢å†™åƒã‚’è€ƒãˆã‚‹ã€‚ãã®è§£ææ–¹æ³•ã¯ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨åŒã˜ãªã®ã§ã€ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆå½¢å¼ã§ç´¹ä»‹ã™ã‚‹ã€‚

$A$ ã‚’ $n$ æ¬¡å…ƒæ­£æ–¹è¡Œåˆ—ã¨ã™ã‚‹ã€‚

$$
\vec{x} \mapsto A \vec{x}, \quad \vec{x} \in \mathbb{R}^n
$$

ã§å®šç¾©ã•ã‚Œã‚‹ $\mathbb{R}^n$ ä¸Šã®é›¢æ•£æ™‚é–“åŠ›å­¦ç³»ã‚’**ç·šå½¢å†™åƒ**ã¨ã„ã†ã€‚

#### 1æ¬¡å…ƒç·šå½¢å†™åƒ

$a$ ã‚’å®Ÿå®šæ•°ã¨ã—ã¦

$$
x \mapsto ax, \quad x \in \mathbb{R}
$$

ã§å®šç¾©ã•ã‚Œã‚‹ã€‚$t = 0$ ã®ã¨ã $x = x_0$ ã‚’é€šã‚‹è»Œé“ã¯

$$
x(t) = a^t x_0, \quad t = 0, \pm 1, \pm 2, \cdots
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚$a$ ã®ç¬¦å·ã«ã‚ˆã£ã¦æŒ™å‹•ãŒæ¬¡ã®ã‚ˆã†ã«å¤‰ã‚ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import matplotlib.pyplot as plt
import numpy as np

t = np.arange(0, 20, 1)

a_values = [1.25, 0.8, -0.8, -1.25]
initial_values = [1, -1]

fig, axs = plt.subplots(2, 2, figsize=(12, 10))

for i, a in enumerate(a_values):
    ax = axs[i // 2, i % 2]

    if a in [1.25, 0.8]:
        for x_0 in initial_values:
            x_t = x_0 * (a**t)
            ax.plot(t, x_t, marker="o", label=f"x_0 = {x_0}, a = {a}")
            for j in range(len(t) - 1):
                ax.annotate(
                    "",
                    xy=(t[j + 1], x_t[j + 1]),
                    xytext=(t[j], x_t[j]),
                    arrowprops=dict(arrowstyle="->", color="black"),
                )
    else:
        x_0 = 1
        x_t = x_0 * (a**t)
        ax.plot(t, x_t, marker="o", label=f"x_0 = {x_0}, a = {a}")
        for j in range(len(t) - 1):
            ax.annotate(
                "",
                xy=(t[j + 1], x_t[j + 1]),
                xytext=(t[j], x_t[j]),
                arrowprops=dict(arrowstyle="->", color="black"),
            )

    ax.set_title(f"a = {a}", fontsize=19)
    ax.set_xlabel("t", fontsize=16)
    ax.set_ylabel("x(t)", fontsize=16)
    ax.grid(True)

plt.tight_layout()
plt.show()
```
:::

![](/images/dynamic-bunki/19.png)

#### 2æ¬¡å…ƒç·šå½¢å†™åƒ

2æ¬¡å…ƒç·šå½¢å†™åƒã¯

$$
A = \begin{pmatrix}
a_{11} & a_{12} \\
a_{21} & a_{22}
\end{pmatrix}
$$

ã¨ã—ã¦æ¬¡ã®å¼ã§å®šç¾©ã•ã‚Œã‚‹ã€‚

$$
\vec{x} \mapsto A \vec{x}, \quad \vec{x} = \begin{pmatrix} x \\ y \end{pmatrix} \in \mathbb{R}^2
$$

2æ¬¡æ­£æ–¹è¡Œåˆ— $A$ ã®å›ºæœ‰æ–¹ç¨‹å¼ã¯2æ¬¡æ–¹ç¨‹å¼ãªã®ã§ã€ä»¥ä¸‹ã®3ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆ†ã‹ã‚Œã‚‹ã€‚

1. å›ºæœ‰æ–¹ç¨‹å¼ã¯ç›¸ç•°ãªã‚‹2ã¤ã®å®Ÿæ ¹ã‚’ã‚‚ã¤
2. å›ºæœ‰æ–¹ç¨‹å¼ã¯1ã¤ã®é‡æ ¹ã‚’ã‚‚ã¤
3. å›ºæœ‰æ–¹ç¨‹å¼ã¯è¤‡ç´ å…±å½¹ãª2ã¤ã®è™šæ ¹ã‚’ã‚‚ã¤

##### ç›¸ç•°ãªã‚‹2ã¤ã®å®Ÿæ ¹ã‚’ã‚‚ã¤å ´åˆ

å›ºæœ‰å€¤ã‚’ $a, b$ ã¨ã™ã‚‹ã¨ã€$t = 0$ ã®ã¨ã $(x,y) = (x_0, y_0)$ ã‚’é€šã‚‹è»Œé“ã¯

$$
\begin{cases}
x(t) = a^t x_0\\
y(t) = b^t y_0, \quad t = 0, \pm 1, \pm 2, \cdots
\end{cases}
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚å„å›ºæœ‰å€¤ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import matplotlib.pyplot as plt
import numpy as np

t = np.arange(0, 25, 1)

# a, bã®å€¤ã®ãƒªã‚¹ãƒˆã¨ãã‚Œãã‚Œã®åˆæœŸå€¤ã®ãƒªã‚¹ãƒˆ
eigenvalues_and_initial_values = [
    (
        (0.8, 0.9),
        [
            (1, 1),
            (-1, 1),
            (1, -1),
            (-1, -1),
            (1, 0.5),
            (1, 0),
            (1, -0.5),
            (-1, 0.5),
            (-1, 0),
            (-1, -0.5),
        ],
    ),
    (
        (0.8, 1.25),
        [
            (-1, 0),
            (1, 0),
            (0, 0.01),
            (0, -0.01),
            (-1, 0.1),
            (-1, -0.1),
            (1, 0.1),
            (1, -0.1),
        ],
    ),
    ((-0.8, 1.25), [(1, 0.1), (-1, -0.1)]),
    ((-0.8, -1.25), [(0.5, -0.5), (-0.5, 0.5), (-0.3, -0.3), (0.3, 0.3)]),
]

fig, axs = plt.subplots(2, 2, figsize=(12, 10))

for i, ((a, b), initial_values) in enumerate(eigenvalues_and_initial_values):
    ax = axs[i // 2, i % 2]

    for x_0, y_0 in initial_values:
        x_t = x_0 * (a**t)
        y_t = y_0 * (b**t)

        ax.scatter(x_t, y_t, marker="o")
        for j in range(len(t) - 1):
            ax.annotate(
                "",
                xy=(x_t[j + 1], y_t[j + 1]),
                xytext=(x_t[j], y_t[j]),
                arrowprops=dict(arrowstyle="->", color="black"),
            )

    ax.set_title(f"a = {a}, b = {b}", fontsize=19)
    ax.set_xlabel("x(t)", fontsize=16)
    ax.set_ylabel("y(t)", fontsize=16)
    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.grid(True)

plt.tight_layout()
plt.show()
```
:::

![](/images/dynamic-bunki/20.png)

##### 1ã¤ã®é‡æ ¹ã‚’ã‚‚ã¤å ´åˆ

é‡æ ¹ã‚’ $a \in \mathbb{R}$ ã¨ã™ã‚‹ã€‚

éšæ•°ãŒ0ã®ã¨ãã€$t = 0$ ã®ã¨ã $(x,y) = (x_0, y_0)$ ã‚’é€šã‚‹è»Œé“ã¯

$$
\begin{cases}
x(t) = a^t x_0 \\
y(t) = a^t y_0, \quad t = 0, \pm 1, \pm 2, \cdots
\end{cases}
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚ç›¸ç©ºé–“ã§ã®è»Œé“ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import matplotlib.pyplot as plt
import numpy as np

t = np.arange(0, 25, 1)

# aã®å€¤ã¨ãã‚Œãã‚Œã®åˆæœŸå€¤ã®ãƒªã‚¹ãƒˆ
a_values_and_initial_values = [
    (
        -0.8,
        [
            (0.5, 1.0),
            (1.0, 0.5),
            (1.5, 2.0),
            (-0.5, -1.0),
            (-1.0, -0.5),
            (-1.5, -2.0),
            (0.5, -1.0),
            (1.0, -0.5),
            (1.5, -2.0),
            (-0.5, 1.0),
            (-1.0, 0.5),
            (-1.5, 2.0),
            (0.0, 1.0),
            (0.0, -1.0),
            (1.0, 0.0),
            (-1.0, 0.0),
        ],
    ),
    (
        0.8,
        [
            (0.5, 1.0),
            (1.0, 0.5),
            (1.5, 2.0),
            (-0.5, -1.0),
            (-1.0, -0.5),
            (-1.5, -2.0),
            (0.5, -1.0),
            (1.0, -0.5),
            (1.5, -2.0),
            (-0.5, 1.0),
            (-1.0, 0.5),
            (-1.5, 2.0),
            (0.0, 1.0),
            (0.0, -1.0),
            (1.0, 0.0),
            (-1.0, 0.0),
        ],
    ),
]

fig, axs = plt.subplots(1, 2, figsize=(12, 6))

for i, (a, initial_values) in enumerate(a_values_and_initial_values):
    ax = axs[i]

    for x_0, y_0 in initial_values:
        x_t = x_0 * (a**t)
        y_t = y_0 * (a**t)

        ax.scatter(x_t, y_t, marker="o")
        for j in range(len(t) - 1):
            if abs(x_t[j + 1]) <= 1 and abs(y_t[j + 1]) <= 1:
                ax.annotate(
                    "",
                    xy=(x_t[j + 1], y_t[j + 1]),
                    xytext=(x_t[j], y_t[j]),
                    arrowprops=dict(arrowstyle="->", color="black"),
                )

    ax.set_title(f"a = {a}", fontsize=19)
    ax.set_xlabel("x(t)", fontsize=16)
    ax.set_ylabel("y(t)", fontsize=16)
    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.grid(True)

plt.tight_layout()
plt.show()
```
:::

![](/images/dynamic-bunki/21.png)

éšæ•°ãŒ1ã®ã¨ãã€$t = 0$ ã®ã¨ã $(x,y) = (x_0, y_0)$ ã‚’é€šã‚‹è»Œé“ã¯

$$
\begin{cases}
x(t) = a^t x_0 + t a^{t-1} y_0 \\
y(t) = a^t y_0, \quad t = 0, \pm 1, \pm 2, \cdots
\end{cases}
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚ç›¸ç©ºé–“ã§ã®è»Œé“ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import matplotlib.pyplot as plt
import numpy as np

t = np.arange(0, 30, 1)

eigenvalues_and_initial_values = [
    (
        -1,
        [
            (1, 1),
            (-1, 1),
            (1, -1),
            (-1, -1),
            (1, 0.5),
            (1, 0),
            (1, -0.5),
            (-1, 0.5),
            (-1, 0),
            (-1, -0.5),
        ],
    ),
    (
        0.6,
        [
            (-1, 0),
            (1, 0),
            (-1, 1),
            (1, -1),
            (-1, 0.5),
            (1, -0.5),
        ],
    ),
    (
        1,
        [
            (-1, 0.8),
            (-1, 0.6),
            (-1, 0.3),
            (1, -0.8),
            (1, -0.6),
            (1, -0.3),
        ],
    ),
    (
        1.5,
        [
            (-0.01, 0),
            (0.01, 0),
            (-0.05, 0.01),
            (0.05, -0.01),
            (-0.15, 0.03),
            (0.15, -0.03),
        ],
    ),
]

fig, axs = plt.subplots(2, 2, figsize=(12, 10))

for i, (a, initial_values) in enumerate(eigenvalues_and_initial_values):
    ax = axs[i // 2, i % 2]

    for x_0, y_0 in initial_values:
        x_t = x_0 * (a ** t[1:]) + y_0 * t[1:] * (a ** (t[1:] - 1))
        x_t = np.insert(x_t, 0, x_0)
        y_t = y_0 * (a**t)
        if i == 0:
            ax.scatter(x_t, y_t, marker="o")
        else:
            ax.plot(x_t, y_t, marker="o")
        for j in range(len(t) - 1):
            ax.annotate(
                "",
                xy=(x_t[j + 1], y_t[j + 1]),
                xytext=(x_t[j], y_t[j]),
                arrowprops=dict(arrowstyle="->", color="black"),
            )

    ax.set_title(f"a = {a}", fontsize=19)
    ax.set_xlabel("x(t)", fontsize=16)
    ax.set_ylabel("y(t)", fontsize=16)
    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.grid(True)

plt.tight_layout()
plt.show()
```
:::

![](/images/dynamic-bunki/22.png)

##### è¤‡ç´ å…±å½¹ãª2ã¤ã®è™šæ ¹ã‚’ã‚‚ã¤å ´åˆ

2ã¤ã®è¤‡ç´ å…±å½¹ãªå›ºæœ‰å€¤ã‚’ $a \pm ib$ï¼ˆ$a, b \in \mathbb{R}$ï¼‰ã¨ã™ã‚‹ã€‚å®Ÿæ•° $r, \theta$ ã‚’

$$
r = \sqrt{a^2 + b^2}, \quad \cos \theta = \frac{a}{r}, \quad \sin \theta = \frac{b}{r}
$$

ã«ã‚ˆã£ã¦å®šç¾©ã™ã‚‹ã¨ã€$t=0$ ã®ã¨ã $(x,y) = (x_0, y_0)$ ã‚’é€šã‚‹è»Œé“ã¯

$$
\begin{cases}
x(t) = r^t (x_0 \cos \theta t + y_0 \sin \theta t) \\
y(t) = r^t (-x_0 \sin \theta t + y_0 \cos \theta t), \quad t = 0, \pm 1, \pm 2, \cdots
\end{cases}
$$

ã§è¡¨ã•ã‚Œã‚‹ã€‚$r$ ã®çµ¶å¯¾å€¤ã«ã‚ˆã£ã¦è»Œé“ã®æ§˜å­ãŒå¤‰åŒ–ã™ã‚‹ã€‚è² ã®å ´åˆã¯æŒ¯å‹•ã—ãŸã‚Šç™ºæ•£ã—ãŸã‚Šã™ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import matplotlib.pyplot as plt
import numpy as np

t = np.arange(0, 60, 1)

# r, Î¸ã®å€¤ã®ãƒªã‚¹ãƒˆã¨ãã‚Œãã‚Œã®åˆæœŸå€¤ã®ãƒªã‚¹ãƒˆ
r_theta_and_initial_values = [
    ((0.95, np.pi / 10), [(1, 1), (-1, 1)]),
    ((1, np.pi / 10), [(0, 0.25), (0, 0.5), (0, 0.75)]),
    ((1.1, np.pi / 10), [(0.01, 0.01), (-0.01, 0.01)]),
]

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, ((r, theta), initial_values) in enumerate(r_theta_and_initial_values):
    ax = axs[i]

    for x_0, y_0 in initial_values:
        x_t = r**t * (x_0 * np.cos(theta * t) + y_0 * np.sin(theta * t))
        y_t = r**t * (-x_0 * np.sin(theta * t) + y_0 * np.cos(theta * t))

        ax.plot(x_t, y_t, marker="o", label=f"x_0 = {x_0}, y_0 = {y_0}")
        for j in range(len(t) - 1):
            if abs(x_t[j + 1]) <= 1 and abs(y_t[j + 1]) <= 1:
                ax.annotate(
                    "",
                    xy=(x_t[j + 1], y_t[j + 1]),
                    xytext=(x_t[j], y_t[j]),
                    arrowprops=dict(arrowstyle="->", color="black"),
                )

    ax.set_title(f"r = {r}, " + r"$\theta = \pi / 10$", fontsize=19)
    ax.set_xlabel("x(t)", fontsize=16)
    ax.set_ylabel("y(t)", fontsize=16)
    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.grid(True)

plt.tight_layout()
plt.show()
```
:::

![](/images/dynamic-bunki/23.png)

## 4. ãƒ™ã‚¯ãƒˆãƒ«å ´ã®å¹³è¡¡ç‚¹ã®åˆ†å²

å˜æŒ¯ã‚Šå­ã®ç¯€ã§è¦‹ãŸã‚ˆã†ã«ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¤‰åŒ–ã•ã›ãŸã¨ãã«åŠ›å­¦ç³»ã®æŒ¯ã‚‹èˆã„ãŒè³ªçš„ã«å¤‰åŒ–ã™ã‚‹ç¾è±¡ã‚’**åˆ†å²ç¾è±¡**ã¨ã„ã†ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\mu \in \mathbb{R}^p$ ã‚’ã‚‚ã¤è‡ªå¾‹ç³»ã®ãƒ™ã‚¯ãƒˆãƒ«å ´

$$
\dot{\vec{x}} = f(\vec{x},\mu), \quad \vec{x} \in \mathbb{R}^n
$$

ã‚’è€ƒãˆã‚‹ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\mu = \mu_0$ ã®ã¨ã $\dot{\vec{x}}$ ãŒ $\vec{0}$ ã«ãªã‚‹ç‚¹ã€ã™ãªã‚ã¡

$$
f(\vec{x}_0, \mu_0) = \vec{0}
$$

ã‚’æº€ãŸã™ç‚¹ $\vec{x} = \vec{x}_0$ ã‚’**å¹³è¡¡ç‚¹**ã¨ã„ã†ã€‚ã¤ã¾ã‚Šã€å¹³è¡¡ç‚¹ã¯ã™ã¹ã¦ã®æ™‚åˆ»ã«ãŠã„ã¦é™æ­¢ã—ã¦ã„ã‚‹çŠ¶æ…‹ã‚’è¡¨ã™ã€‚åŸç‚¹ $O$ ã¯ä»»æ„ã®ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã®å¹³è¡¡ç‚¹ã§ã‚ã‚‹ã€‚

å¹³è¡¡ç‚¹ã‹ã‚‰å°‘ã—ãšã‚ŒãŸã¨ãã«ã©ã®ã‚ˆã†ãªæŒ™å‹•ã‚’ã™ã‚‹ã‹ã‚’èª¿ã¹ã‚‹ã“ã¨ã‚’å®‰å®šæ€§è§£æã¨ã„ã†ã€‚å®‰å®šæ€§ã«ã¯ã„ãã¤ã‹å®šç¾©ãŒã‚ã‚‹ãŒã€ä»Šå›ã¯**æ¼¸è¿‘å®‰å®šæ€§**ã‚’ç´¹ä»‹ã™ã‚‹ã€‚æ¼¸è¿‘å®‰å®šæ€§ã¯ã€å¹³è¡¡ç‚¹ã®è¿‘ãã«ã‚ã‚‹ç‚¹ãŒæ™‚é–“ã¨ã¨ã‚‚ã«å¹³è¡¡ç‚¹ã«åæŸã™ã‚‹ã“ã¨ã‚’æ„å‘³ã™ã‚‹ã€‚

æ¼¸è¿‘å®‰å®šæ€§ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã«ã¯å¹³è¡¡ç‚¹ã‹ã‚‰ã®å¾®å°ã®ãšã‚Œï¼ˆ**å¤‰åˆ†**ï¼‰ã«æ³¨ç›®ã™ã‚Œã°ã‚ˆã„ã€‚ç‚¹ $\vec{x}_0 \in \mathbb{R}^n$ ã‚’å¹³è¡¡ç‚¹ã¨ã—ã€ãã“ã‹ã‚‰ã®å¤‰åˆ†ã‚’ $\xi(t)$ ã¨ã™ã‚‹ã€‚å¤‰åˆ†ã«å¯¾ã™ã‚‹æ–¹ç¨‹å¼ã‚’å¾—ã‚‹ãŸã‚

$$
\vec{x}(t) = \vec{x}_0 + \xi(t)
$$

ã®é‹å‹•ã‚’è€ƒãˆã‚‹ã€‚

$$
\dot{\vec{x}}(t) = \dot{\vec{x}}_0 + \dot{\xi}(t) = f(\vec{x}_0 + \xi(t))
$$

å¤‰åˆ† $\xi(t)$ ã‚’ååˆ†å°ã•ã„ã¨ã™ã‚‹ã¨ã€å¹³è¡¡ç‚¹ $\vec{x}_0$ å‘¨ã‚Šã§ãƒ†ã‚¤ãƒ©ãƒ¼å±•é–‹ã—ã¦ã€

$$
f(\vec{x}_0 + \xi(t)) = f(\vec{x}_0) + \left. \frac{\partial f}{\partial \vec{x}} \right|_{\vec{x}(t) = \vec{x}_0} \xi(t) + O(\xi^2(t))
$$

1æ¬¡è¿‘ä¼¼ã™ã‚‹ã¨ã€

$$
\dot{\xi}(t) = A \xi(t)
$$

ã¨ã„ã†ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã‚’å¾—ã‚‹ã€‚ã“ã“ã§ã€

$$
A = D_{\vec{x}} f(\vec{x}_0) = \left. \frac{\partial f}{\partial \vec{x}} \right|_{\vec{x}(t) = \vec{x}_0} = \left( \left. \frac{\partial f_i}{\partial x_j} \right|_{\vec{x}(t) = \vec{x}_0} \right)_{1 \leq i,j \leq n}
$$

ã¨ãŠã„ãŸã€‚ã“ã® $A$ ã¯ãƒ¤ã‚³ãƒ“è¡Œåˆ—ã§ã‚ã‚‹ã€‚

$A$ ã®ã™ã¹ã¦ã®å›ºæœ‰å€¤ã®å®Ÿéƒ¨ãŒéé›¶ã§ã‚ã‚‹ã¨ãã€å¹³è¡¡ç‚¹ $\vec{x}_0$ ã¯**åŒæ›²å‹**ã§ã‚ã‚‹ã¨ã„ã†ã€‚è¨¼æ˜ã¯çœç•¥ã™ã‚‹ãŒã€$\vec{x}_0$ ãŒåŒæ›²å‹ã§ $A$ ã®ã™ã¹ã¦ã®å›ºæœ‰å€¤ã®å®Ÿéƒ¨ãŒè² ã§ã‚ã‚‹ã¨ãã€$\vec{x}_0$ ã¯**æ¼¸è¿‘å®‰å®š**ã§ã‚ã‚‹ã€‚ã¾ãŸã€$\vec{x}_0$ ãŒåŒæ›²å‹ã§ $A$ ã®å°‘ãªãã¨ã‚‚1ã¤ã®å›ºæœ‰å€¤ã®å®Ÿéƒ¨ãŒæ­£ã§ã‚ã‚‹ã¨ãã€$\vec{x}_0$ ã¯ä¸å®‰å®šã§ã‚ã‚‹ã€‚

å‰ã®ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã®èª¬æ˜ã§æŒ™ã’ãŸä¾‹ã§ã¯ã€å›ºæœ‰å€¤ã®å®Ÿéƒ¨ãŒã™ã¹ã¦è² ã§ã‚ã‚‹ã¨ãã¯åŸç‚¹ $O$ ã«åæŸã—ã¦ã„ãŸã“ã¨ãŒç¢ºèªã§ãã‚‹ã€‚ã¤ã¾ã‚Šã€ã“ã®å ´åˆã®1æ¬¡è¿‘ä¼¼ãŒå¦¥å½“ãªç¯„å›²ã®å¤‰åˆ† $\xi(t)$ ã¯ $t \rightarrow \infty$ ã§ åŸç‚¹ $O$ ã«åæŸã—ã€å¹³è¡¡ç‚¹ $\vec{x}_0$ ãŒæ¼¸è¿‘å®‰å®šã§ã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã™ã‚‹ã€‚

---

ï¼ˆä¾‹ï¼‰å®Ÿéš›ã«å˜æŒ¯ã‚Šå­ã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã§å®‰å®šæ€§ã‚’èª¿ã¹ã¦ã¿ã‚ˆã†ã€‚ã¾ãšã¯ã€æ‘©æ“¦ã‚„ç©ºæ°—æŠµæŠ—ã‚’ç„¡è¦–ã—ãŸå ´åˆã‚’è€ƒãˆã‚‹ï¼ˆ$g/l=1$ï¼‰ã€‚

$$
\begin{cases}
\dot{\theta} = \omega \\
\dot{\omega} = -\sin \theta, \quad 0 \leq \theta < 2\pi
\end{cases}
$$

$(\dot{\theta}, \dot{\omega}) = (0,0)$ ã¨ãªã‚‹å¹³è¡¡ç‚¹ $(\theta_0, \omega_0)$ ã¯

$$
\begin{cases}
\theta_0 = 0, \pi \\
\omega_0 = 0
\end{cases}
$$

- $(\theta_0, \omega_0) = (0, \pi)$ ã®ã¨ã

å¤‰åˆ† $\xi(t) \in \mathbb{R}^2$ ã«ã¤ã„ã¦ã®ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¯ã€

$$
\dot{\xi}(t) = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix} \xi(t)
$$

ã¨ãªã‚‹ã€‚å›ºæœ‰å€¤ã¯ $\pm 1$ ã¨æ­£ã®å€¤ã‚’å«ã‚“ã§ã„ã‚‹ã®ã§ã€ã“ã®å¹³è¡¡ç‚¹ã¯ä¸å®‰å®šã§ã‚ã‚‹ã€‚ã“ã‚Œã¯ç›´æ„Ÿã«ä¸€è‡´ã™ã‚‹ã€‚

- $(\theta_0, \omega_0) = (0, 0)$ ã®ã¨ã

å¤‰åˆ† $\xi(t) \in \mathbb{R}^2$ ã«ã¤ã„ã¦ã®ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¯ã€

$$
\dot{\xi}(t) = \begin{pmatrix} 0 & 1 \\ -1 & 0 \end{pmatrix} \xi(t)
$$

ã¨ãªã‚‹ã€‚å›ºæœ‰å€¤ã¯ $\pm i$ ã¨å®Ÿéƒ¨ãŒ $0$ ãªã®ã§ã€å›ºæœ‰å€¤ã‚’ç”¨ã„ãŸæ–¹æ³•ã§ã¯åˆ¤å®šã§ããªã„ã€‚ãƒªãƒ¤ãƒ—ãƒãƒ•é–¢æ•°ã¨ã„ã£ãŸåˆ¥ã®æ‰‹æ³•ã‚’è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

æ¬¡ã«é€Ÿåº¦ã«æ¯”ä¾‹ã™ã‚‹ç©ºæ°—æŠµæŠ—ã®é …ã‚’è¿½åŠ ã™ã‚‹ï¼ˆ$g/l=c/m=1$ï¼‰ã€‚

$$
\begin{cases}
\dot{\theta} = \omega \\
\dot{\omega} = -\sin \theta - \omega, \quad 0 \leq \theta < 2\pi
\end{cases}
$$

å¹³è¡¡ç‚¹ã¯ã•ãã»ã©ã¨åŒã˜ã§ã‚ã‚‹ã€‚$(0, \pi)$ ã¯å¤‰ã‚ã‚‰ãšä¸å®‰å®šã ãŒã€$(0,0)$ ã§ã¯é¢ç™½ã„å¤‰åŒ–ãŒç”Ÿã˜ã‚‹ã€‚

- $(\theta_0, \omega_0) = (0, 0)$ ã®ã¨ã

å¤‰åˆ† $\xi(t) \in \mathbb{R}^2$ ã«ã¤ã„ã¦ã®ç·šå½¢ãƒ™ã‚¯ãƒˆãƒ«å ´ã¯ã€

$$
\dot{\xi}(t) = \begin{pmatrix} 0 & 1 \\ -1 & -1 \end{pmatrix} \xi(t)
$$

ã§ã‚ã‚‹ã€‚å›ºæœ‰å€¤ã¯ $-1/2 \pm i \sqrt{3}$ ã¨å®Ÿéƒ¨ãŒã™ã¹ã¦è² ãªã®ã§ã€ã“ã®å¹³è¡¡ç‚¹ã¯æ¼¸è¿‘å®‰å®šã§ã‚ã‚‹ã€‚ã•ãã»ã©ã¯å®‰å®šæ€§ã‚’åˆ¤å®šã§ããªã‹ã£ãŸç‚¹ãŒã€ç©ºæ°—æŠµæŠ—ã‚’åŠ ãˆã‚‹ã“ã¨ã§ã€å›ºæœ‰å€¤ã‚’ä½¿ã£ã¦åˆ¤å®šã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸï¼

---

ãƒ™ã‚¯ãƒˆãƒ«å ´ã®å¹³è¡¡ç‚¹ã®åˆ†å²ã‚’èª¿ã¹ã‚‹ãŸã‚ã«ã¯æ¬¡ã®å®šç†ãŒé‡è¦ã§ã‚ã‚‹ã€‚

> $\mu = \mu_0$ ã«ãŠã„ã¦å¹³è¡¡ç‚¹ $\vec{x}_0$ ãŒåŒæ›²å‹ã§ã‚ã‚Œã°ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\mu = \mu_0$ ã®è¿‘å‚ã§å¤‰åŒ–ã•ã›ã‚‹ã¨ãã€å¹³è¡¡ç‚¹ã¯æŒç¶šã—ã¦ã€å®‰å®šæ€§ã®å‹ã¯å¤‰åŒ–ã—ãªã„ã€‚

ã“ã®å®šç†ã‹ã‚‰ã€ãƒ™ã‚¯ãƒˆãƒ«å ´ã®å¹³è¡¡ç‚¹ã®åˆ†å²ã‚’è€ƒãˆã‚‹ã«ã¯ã€$\mu = \vec{0}$ ã®ã¨ãã€åŸç‚¹ã«éåŒæ›²å‹å¹³è¡¡ç‚¹ã‚’ã‚‚ã¤å ´åˆã‚’è€ƒãˆã‚Œã°ã‚ˆã„ã“ã¨ãŒã‚ã‹ã‚‹ã€‚$\mu = \vec{0}$ ã‚„åŸç‚¹ã«ã—ã¦ã„ã‚‹ã®ã¯å˜ã«ç°¡å˜ã«ãªã‚‹ã‹ã‚‰ã¨ã„ã†ç†ç”±ã§ã‚ã‚‹ã€‚åˆ¥ã«é©å½“ãªç‚¹ã‚’å–ã£ã¦ãã¦ã‚‚ã‚ˆã„ãŒã€å¹³è¡Œç§»å‹•ã™ã‚Œã°å½¢ã¯åŒã˜ãªã®ã§ã€ç‰¹ã«ä¸€èˆ¬æ€§ã¯å¤±ã‚ã‚Œãªã„ã€‚

### 1æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å ´

#### ã‚µãƒ‰ãƒ«ãƒ»ãƒãƒ¼ãƒ‰åˆ†å²

1æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å ´

$$
\dot{x} = f(x, \mu)
$$

ãŒ $f(0,0) = 0$, $f_x(0,0) = 0$ ã‚’æº€ãŸã™ã¨ãã€

$$
f_\mu (0,0) \ne 0, \quad f_{xx}(0,0) \ne 0
$$

ãªã‚‰ã°ã€$\mu = 0$ ã®ã¨ã $x=0$ ã«ãŠã„ã¦**ã‚µãƒ‰ãƒ«ãƒ»ãƒãƒ¼ãƒ‰åˆ†å²**ãŒç”Ÿã˜ã‚‹ã€‚ãã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æ¨™æº–å½¢ã¯

$$
\dot{x} = \mu \mp x^2
$$

ã§ä¸ãˆã‚‰ã‚Œã‚‹ã€‚ãƒã‚¤ãƒŠã‚¹ç¬¦å·ã®å ´åˆã¯æ¬¡ã®ã‚ˆã†ãªå¤‰åŒ–ã‚’ã™ã‚‹ã€‚

- $\mu < 0$ï¼šå¹³è¡¡ç‚¹ã‚’ã‚‚ãŸãªã„ã€‚
- $\mu = 0$ï¼š$x = 0$ ã«å›ºæœ‰å€¤ $0$ ã‚’ã‚‚ã¤å¹³è¡¡ç‚¹ã‚’ã‚‚ã¤ã€‚
- $\mu > 0$ï¼š2ã¤ã®å¹³è¡¡ç‚¹ $P^+ = \sqrt{\mu}$, $P^- = -\sqrt{\mu}$ ã‚’ã‚‚ã¤ã€‚$P^+$ ã®å›ºæœ‰å€¤ã¯ $f_x(\sqrt{\mu}, \mu) = -2\sqrt{\mu} < 0$ ã§å®‰å®šã€$P^-$ ã®å›ºæœ‰å€¤ã¯ $f_x(-\sqrt{\mu}, \mu) = 2\sqrt{\mu}>0$ ã§ä¸å®‰å®šã§ã‚ã‚‹ã€‚

ã‚°ãƒ©ãƒ•ã«ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import matplotlib.pyplot as plt
import numpy as np

mus = np.array([-0.3, 0, 0.3])
x = np.arange(-1, 1, 0.01)

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, mu in enumerate(mus):
    ax = axs[i]
    xdot = mu - x * x
    ax.plot(x, xdot, linewidth=1.5, color="red")
    if i == 1:
        ax.scatter(0, 0, marker="o", s=150, color="black")
        ax.arrow(
            1.0,
            0,
            -0.7,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            0,
            0,
            -0.3,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
    elif i == 2:
        ax.scatter(np.sqrt(mu), 0, marker="o", s=150, color="black")
        ax.scatter(-np.sqrt(mu), 0, marker="o", s=150, color="blue")
        ax.arrow(
            -np.sqrt(mu),
            0,
            -0.3,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            -np.sqrt(mu),
            0,
            0.8,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            1,
            0,
            -0.2,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
    ax.set_title(rf"$\mu = {mu}$", fontsize=19)
    ax.set_xlabel(r"$x(t)$", fontsize=16)
    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.axhline(0, color="black", linewidth=0.7)
    ax.axvline(0, color="black", linewidth=0.7)
    ax.grid(True)

plt.tight_layout()
plt.show()
```
:::

![](/images/dynamic-bunki/24.png)

$\mu$ ã‚’æ­£ã‹ã‚‰è² ã«å¤‰åŒ–ã•ã›ãŸã¨ãã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¤‰åŒ–ã«ã¨ã‚‚ãªã£ã¦ã€å®‰å®šå¹³è¡¡ç‚¹ã¨ä¸å®‰å®šå¹³è¡¡ç‚¹ãŒè¿‘ã¥ã„ã¦åˆä½“ã—æ¶ˆæ»…ã™ã‚‹ã€‚ä»¥ä¸‹ã®gifã¯[Wikipedia](https://ja.wikipedia.org/wiki/%E3%82%B5%E3%83%89%E3%83%AB%E3%83%8E%E3%83%BC%E3%83%89%E5%88%86%E5%B2%90)ã‹ã‚‰å¼•ç”¨ã—ã¦ããŸã‚‚ã®ã§ã‚ã‚‹ã€‚

![](/images/dynamic-bunki/Saddle_node_bifurcation_-_animation.gif)

1æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å ´ã§ä¸€èˆ¬çš„ã«è¦³æ¸¬ã•ã‚Œã‚‹ã®ã¯ã‚µãƒ‰ãƒ«ãƒ»ãƒãƒ¼ãƒ‰åˆ†å²ã®ã¿ã§ã‚ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ã€‚ãŸã ã—ã€æ‹˜æŸæ¡ä»¶ã‚’ä»˜ã‘åŠ ãˆã‚‹ã¨åˆ¥ã®åˆ†å²ãŒç”Ÿã˜ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚

#### ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«åˆ†å²

**ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«åˆ†å²**ã¯åŸç‚¹ã«å¹³è¡¡ç‚¹ã‚’æŒã¤ã¨ã„ã†æ‹˜æŸæ¡ä»¶ã‚’èª²ã—ãŸã¨ãã«ç”Ÿã˜ã‚‹åˆ†å²ã§ã‚ã‚‹ã€‚ä¸€èˆ¬ã«1æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å ´

$$
\dot{x} = f(x, \mu)
$$

ãŒ $f(0,0) = 0$, $f_x(0,0) = 0$ ã‚’æº€ãŸã™ã¨ãã€

$$
f_\mu (0,0) = 0, \quad f_{x\mu}(0,0) \ne 0 ,\quad f_{xx}(0,0) \ne 0
$$

ãªã‚‰ã°ã€$\mu = 0$ ã®ã¨ã $x=0$ ã«ãŠã„ã¦ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«åˆ†å²ãŒç”Ÿã˜ã‚‹ã€‚ãã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æ¨™æº–å½¢ã¯

$$
\dot{x} = \mu x \mp x^2
$$

ã§ä¸ãˆã‚‰ã‚Œã‚‹ã€‚ãƒã‚¤ãƒŠã‚¹ç¬¦å·ã®å ´åˆã¯æ¬¡ã®ã‚ˆã†ãªå¤‰åŒ–ã‚’ã™ã‚‹ã€‚

- $\mu < 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $\mu < 0$ ã‚’æŒã¡å®‰å®šã€å¹³è¡¡ç‚¹ $P = \mu$ ã¯å›ºæœ‰å€¤ $-\mu > 0$ ã‚’æŒã¡ä¸å®‰å®šã€‚
- $\mu = 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $0$ã€‚
- $\mu > 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $\mu > 0$ ã‚’æŒã¡ä¸å®‰å®šã€å¹³è¡¡ç‚¹ $P = \mu$ ã¯å›ºæœ‰å€¤ $-\mu < 0$ ã‚’æŒã¡å®‰å®šã€‚

å›³ç¤ºã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚å¹³è¡¡ç‚¹ã®å®‰å®šæ€§ãŒæ­£è² ã§äº¤ä»£ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import matplotlib.pyplot as plt
import numpy as np

mus = np.array([-0.7, 0, 0.7])
x = np.arange(-1, 1, 0.01)

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, mu in enumerate(mus):
    ax = axs[i]
    xdot = x * (mu - x)
    ax.plot(x, xdot, linewidth=1.5, color="red")
    if i == 0:
        ax.scatter(0, 0, marker="o", s=150, color="black")
        ax.scatter(mu, 0, marker="o", s=150, color="blue")
        ax.arrow(
            mu,
            0,
            -0.2,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            mu,
            0,
            0.3,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            1,
            0,
            -0.55,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
    elif i == 1:
        ax.scatter(0, 0, marker="o", s=150, color="blue")
        ax.arrow(
            1.0,
            0,
            -0.7,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            0,
            0,
            -0.3,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
    elif i == 2:
        ax.scatter(0, 0, marker="o", s=150, color="blue")
        ax.scatter(mu, 0, marker="o", s=150, color="black")
        ax.arrow(
            1,
            0,
            -0.1,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            0,
            0,
            0.3,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            0,
            0,
            -0.3,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
    ax.set_title(rf"$\mu = {mu}$", fontsize=19)
    ax.set_xlabel(r"$x(t)$", fontsize=16)
    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.axhline(0, color="black", linewidth=0.7)
    ax.axvline(0, color="black", linewidth=0.7)
    ax.grid(True)

plt.tight_layout()
plt.show()
```
:::

![](/images/dynamic-bunki/25.png)

ä»¥ä¸‹ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯[Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%86%E3%82%A3%E3%82%AB%E3%83%AB%E5%88%86%E5%B2%90)ã‹ã‚‰å¼•ç”¨ã—ã¦ããŸã‚‚ã®ã§ã‚ã‚‹ã€‚

![](/images/dynamic-bunki/Transcritical_bifurcation.gif)

#### ãƒ”ãƒƒãƒãƒ•ã‚©ãƒ¼ã‚¯åˆ†å²

ãƒ™ã‚¯ãƒˆãƒ«å ´ $\dot{x} = f(x, \mu)$ ãŒ $x$ ã«é–¢ã—ã¦å¥‡é–¢æ•°

$$
f(-x, \mu) = -f(x, \mu)
$$

ã¨ã„ã†æ‹˜æŸæ¡ä»¶ã‚’èª²ã•ã‚ŒãŸã¨ãã«**ãƒ”ãƒƒãƒãƒ•ã‚©ãƒ¼ã‚¯åˆ†å²**ãŒç”Ÿã˜ã‚‹ã€‚ä¸€èˆ¬ã«1æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å ´ $\dot{x} = f(x, \mu)$ ãŒ $f(0,0) = 0$, $f_x(0,0) = 0$ ã‚’æº€ãŸã™ã¨ãã€

$$
f_\mu(0,0) = f_{xx}(0,0) = 0, \quad f_{x\mu}(0,0) \ne 0, \quad f_{xxx}(0,0) \ne 0
$$

ãªã‚‰ã°ã€$\mu = 0$ ã®ã¨ã $x = 0$ ã«ãŠã„ã¦ãƒ”ãƒƒãƒãƒ•ã‚©ãƒ¼ã‚¯åˆ†å²ãŒç”Ÿã˜ã‚‹ã€‚ãã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã®æ¨™æº–å½¢ã¯

$$
\dot{x} = \mu x \mp x^3
$$

ã§ä¸ãˆã‚‰ã‚Œã‚‹ã€‚ãƒã‚¤ãƒŠã‚¹ç¬¦å·ã®ã¨ãã®åˆ†å²ã®æ§˜å­ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

- $\mu < 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $\mu < 0$ ã‚’æŒã¡å®‰å®šã€‚
- $\mu = 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $0$ ã‚’æŒã¤ã€‚
- $\mu > 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $\mu > 0$ ã‚’æŒã¡ä¸å®‰å®šã€‚å¹³è¡¡ç‚¹ $P^{\pm} = \pm \sqrt{\mu}$ ã¯å›ºæœ‰å€¤ $-2\mu$ ã‚’æŒã¡å®‰å®šã€‚ 

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import matplotlib.pyplot as plt
import numpy as np

mus = np.array([-0.5, 0, 0.5])
x = np.arange(-1, 1, 0.01)

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, mu in enumerate(mus):
    ax = axs[i]
    xdot = x * (mu - x * x)
    ax.plot(x, xdot, linewidth=1.5, color="red")
    if i == 0 or i == 1:
        ax.scatter(0, 0, marker="o", s=150, color="black")
        ax.arrow(
            1.0,
            0,
            -0.7,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            -1.0,
            0,
            0.7,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
    elif i == 2:
        ax.scatter(0, 0, marker="o", s=150, color="blue")
        ax.scatter(np.sqrt(mu), 0, marker="o", s=150, color="black")
        ax.scatter(-np.sqrt(mu), 0, marker="o", s=150, color="black")
        ax.arrow(
            -1,
            0,
            0.1,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            0,
            0,
            -0.5,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            0,
            0,
            0.5,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
        ax.arrow(
            1,
            0,
            -0.1,
            0,
            head_width=0.08,
            head_length=0.05,
            fc="black",
            ec="black",
            linewidth=0.7,
        )
    ax.set_title(rf"$\mu = {mu}$", fontsize=19)
    ax.set_xlabel(r"$x(t)$", fontsize=16)
    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.axhline(0, color="black", linewidth=0.7)
    ax.axvline(0, color="black", linewidth=0.7)
    ax.grid(True)

plt.tight_layout()
plt.show()
```

:::

![](/images/dynamic-bunki/26.png)

è² ã‹ã‚‰æ­£ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‹•ã‹ã™ã¨ã€å®‰å®šå¹³è¡¡ç‚¹ $O$ ãŒä¸å®‰å®šåŒ–ã—ã€ãã®ä¸¡å´ã«å®‰å®šå¹³è¡¡ç‚¹ $P^{\pm}$ ãŒç™ºç”Ÿã™ã‚‹ã€‚è¦‹ãŸç›®ã‹ã‚‰ç†Šæ‰‹å‹åˆ†å²ã¨ã„ã†å¯æ„›ã‚‰ã—ã„åå‰ã‚‚ã‚ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation
from IPython.display import Image

plt.rcParams["figure.dpi"] = 200
plt.rcParams["font.family"] = "serif"
plt.rcParams["mathtext.fontset"] = "cm"


def f(x, mu):
    return x * (mu - x**2)


fig, ax = plt.subplots()
x = np.linspace(-4, 4, 400)
(line,) = ax.plot(x, f(x, -10), color="red", linewidth=1.5)

ax.grid(True)
ax.axhline(0, color="black", linewidth=0.7)
ax.axvline(0, color="black", linewidth=0.7)
ax.set_xlim(-4, 4)
ax.set_ylim(-30, 30)
ax.set_xlabel(r"$x$", fontsize=16)
ax.set_ylabel(r"$f(x, \mu)$", fontsize=16)
title = ax.set_title(r"$\mu = -10$", fontsize=19)

# åˆæœŸåŒ–
scatter_origin = ax.scatter(0, 0, marker="o", s=110, color="black")
scatter1 = ax.scatter([], [], marker="o", s=110, color="black")
scatter2 = ax.scatter([], [], marker="o", s=110, color="black")


def update(mu):
    line.set_ydata(f(x, mu))
    title.set_text(r"$\mu = {:.1f}$".format(mu))

    if mu >= 0:
        scatter_origin.set_color("blue")
    else:
        scatter_origin.set_color("black")

    if mu > 0:
        scatter1.set_offsets([[np.sqrt(mu), 0]])
        scatter2.set_offsets([[-np.sqrt(mu), 0]])
        scatter1.set_sizes([110])
        scatter2.set_sizes([110])
    else:
        scatter1.set_offsets([[0, 0]])
        scatter1.set_sizes([0])
        scatter2.set_offsets([[0, 0]])
        scatter2.set_sizes([0])

    return line, title, scatter_origin, scatter1, scatter2


ani = FuncAnimation(fig, update, frames=np.linspace(10, -5, 20), blit=True)
ani.save("./fig/function_animation.gif", writer="imagemagick")
plt.close(fig)

Image("./fig/function_animation.gif")
```

:::

![](/images/dynamic-bunki/function_animation.gif)

### 2æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å ´

æ¬¡ã«2æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å ´ã®åˆ†å²ã‚’è¦‹ã¦ã„ãã€‚

$$
\begin{align*}
&\dot{\vec{x}} = f(\vec{x}, \mu) = \left( f_1(x,y,\mu), f_2(x,y,\mu) \right)^T \\
&\vec{x} = (x, y)^T \in \mathbb{R}^2, \quad \mu \in \mathbb{R}
\end{align*}
$$

1æ¬¡å…ƒã¨åŒæ§˜ã§ã€$\mu = 0$ ã®ã¨ã $\vec{x} = \vec{0}$ ã«éåŒæ›²å‹å¹³è¡¡ç‚¹ã‚’æŒã¤å ´åˆã‚’è€ƒãˆã‚‹ã€‚ãƒ¤ã‚³ãƒ“è¡Œåˆ—

$$
A = \begin{pmatrix}
(f_1)_x & (f_1)_y \\
(f_2)_x & (f_2)_y
\end{pmatrix}
$$

ãŒå›ºæœ‰å€¤ã®1ã¤ã«0ã‚’ã‚‚ã¤å ´åˆã¨ã€1çµ„ã®è¤‡ç´ å…±å½¹å›ºæœ‰å€¤ãŒç´”è™šæ•°ã«ãªã‚‹å ´åˆã®åˆ†å²ã‚’è¿°ã¹ã‚‹ã€‚

#### ã‚µãƒ‰ãƒ«ãƒ»ãƒãƒ¼ãƒ‰åˆ†å²

ãƒ¤ã‚³ãƒ“è¡Œåˆ—ã®å›ºæœ‰å€¤ã®1ã¤ã«0ã‚’æŒã¤ãƒ™ã‚¯ãƒˆãƒ«å ´

$$
\begin{cases}
\dot{x} = \mu - x^2 \\
\dot{y} = -y
\end{cases}
$$

ã‚’è€ƒãˆã‚‹ã€‚åˆ†å²ã®æ§˜å­ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

- $\mu < 0$ï¼šå¹³è¡¡ç‚¹ãªã—ã€‚
- $\mu = 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $0, -1$ ã‚’æŒã¤ã€‚
- $\mu > 0$ï¼šå¹³è¡¡ç‚¹ $P^+ = (\sqrt{\mu}, 0)$ ã¯å›ºæœ‰å€¤ $-2\sqrt{\mu}, -1$ ã‚’æŒã¡å®‰å®šï¼ˆãƒãƒ¼ãƒ‰ï¼‰ã€‚å¹³è¡¡ç‚¹ $P^- = (-\sqrt{\mu}, 0)$ ã¯å›ºæœ‰å€¤ $2\sqrt{\mu}, -1$ ã‚’æŒã¡ä¸å®‰å®šï¼ˆã‚µãƒ‰ãƒ«ï¼‰ã€‚

å›³ç¤ºã—ã¦ã¿ã‚‹ã¨ã€$y$ è»¸æ–¹å‘ã®å®‰å®šæ€§ã¯å¤‰åŒ–ã—ã¦ã„ãªã„ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ã“ã‚Œã¯ã¤ã¾ã‚Š1æ¬¡å…ƒã®åˆ†å²å•é¡Œã«å¸°ç€ã§ãã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp


def f(t, X, mu):
    x, y = X
    dydt = [mu - x**2, -y]
    return dydt


t_span = (0, 10)
t_eval = np.linspace(t_span[0], t_span[1], 1000)

initial_conditions_lists = [
    [
        [5, 0],
        [5, 3],
        [5, -3],
        [2, 5],
        [2, -5],
        [-1, 5],
        [-1, -5],
    ],
    [
        [5, 0],
        [-0.1, 0],
        [0, 5],
        [0, -5],
        [3, 5],
        [3, -5],
        [-1, 5],
        [-1, -5],
        [-0.5, 3],
        [-0.5, -3],
    ],
    [
        [5, 0],
        [-0.9, 0],
        [-1.1, 0],
        [0, 5],
        [0, -5],
        [1, 5],
        [1, -5],
        [3, 5],
        [3, -5],
        [-1, 5],
        [-1, -5],
        [-2, 5],
        [-2, -5],
        [-1.5, 4],
        [-1.5, -4],
    ],
]
mus = [-1, 0, 1]

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, mu in enumerate(mus):
    ax = axs[i]

    for initial_conditions in initial_conditions_lists[i]:
        sol = solve_ivp(f, t_span, initial_conditions, args=(mu,), t_eval=t_eval)
        ax.plot(sol.y[0], sol.y[1], color="black")

        idx = len(sol.t) // 3
        ax.annotate(
            "",
            xy=(sol.y[0][idx], sol.y[1][idx]),
            xytext=(sol.y[0][idx - 1], sol.y[1][idx - 1]),
            arrowprops=dict(arrowstyle="->", color="black", mutation_scale=20),
        )

    ax.grid(True)
    ax.set_xlim(-5, 5)
    ax.set_ylim(-5, 5)
    ax.set_xlabel(r"$x$", fontsize=16)
    ax.set_ylabel(r"$y$", fontsize=16)
    if i == 0:
        ax.set_title(r"$\mu < 0$", fontsize=19)
    elif i == 1:
        ax.scatter(0, 0, marker="o", s=150, color="black")
        ax.set_title(r"$\mu = 0$", fontsize=19)
    elif i == 2:
        ax.scatter(1, 0, marker="o", s=150, color="black")
        ax.scatter(-1, 0, marker="o", s=150, color="blue")
        ax.set_title(r"$\mu > 0$", fontsize=19)

plt.show()
```

:::

![](/images/dynamic-bunki/27.png)

#### ãƒã‚¢ãƒ³ã‚«ãƒ¬ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ãƒãƒ•ãƒ»ãƒ›ãƒƒãƒ—åˆ†å²

ãƒ¤ã‚³ãƒ“è¡Œåˆ—ã®1çµ„ã®è¤‡ç´ å…±å½¹å›ºæœ‰å€¤ãŒç´”è™šæ•°ã«ãªã‚‹å ´åˆã‚’è€ƒãˆã‚‹ã€‚2æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«å ´

$$
\begin{cases}
\dot{x} = \mu x - \omega y - x(x^2 + y^2) \\
\dot{y} = \mu y + \omega x - y(x^2 + y^2)
\end{cases}
$$

ã‚’è€ƒãˆã‚‹ã€‚æ¥µåº§æ¨™å¤‰æ› $(x, y) = (r\cos\theta, r\sin\theta)$ ã‚’ã™ã‚‹ã¨ã€

$$
\begin{cases}
\dot{r} = r(\mu - r^2) \\
\dot{\theta} = \omega
\end{cases}
$$

ã¨ãªã‚‹ã€‚å¹³è¡¡ç‚¹ $O$ ã«ãŠã‘ã‚‹ãƒ¤ã‚³ãƒ“è¡Œåˆ—ã¯

$$
A = \begin{pmatrix}
\mu & -\omega \\
\omega & \mu
\end{pmatrix}
$$

$\mu$ ã‚’å¤‰åŒ–ã•ã›ãŸã¨ãã®ãƒ™ã‚¯ãƒˆãƒ«å ´ã¯æ¬¡ã®ç‰¹å¾´ã‚’æŒã¤ã€‚

- $\mu < 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯è¤‡ç´ å…±å½¹å›ºæœ‰å€¤ $\mu \pm i\omega$ ã‚’æŒã¡å®‰å®šã€‚
- $\mu = 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯å…±å½¹ãªç´”è™šæ•°å›ºæœ‰å€¤ $\pm i\omega$ ã‚’æŒã¤ã€‚
- $\mu > 0$ï¼šå¹³è¡¡ç‚¹ $O$ ã¯è¤‡ç´ å…±å½¹å›ºæœ‰å€¤ $\mu \pm i\omega$ ã‚’æŒã¡ä¸å®‰å®šã€‚ãã®å‘¨å›²ã«ã€å®‰å®šãªå‘¨å›è»Œé“ã‚’ã‚‚ã¤ã€‚

ã“ã®ã‚ˆã†ã«ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å¤‰åŒ–ã«ã‚ˆã‚Šå®‰å®šå¹³è¡¡ç‚¹ãŒä¸å®‰å®šã«ãªã‚Šã€ãã®å‘¨å›²ã«å®‰å®šãªå‘¨å›è»Œé“ãŒç”Ÿã˜ã‚‹ã‚ˆã†ãªåˆ†å²ã‚’**ãƒã‚¢ãƒ³ã‚«ãƒ¬ãƒ»ã‚¢ãƒ³ãƒ‰ãƒ­ãƒãƒ•ãƒ»ãƒ›ãƒƒãƒ—åˆ†å²**ã¨ã„ã†ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp


def f(t, X, mu):
    x, y = X
    omega = 5
    dydt = [
        mu * x - omega * y - x * (x**2 + y**2),
        mu * y + omega * x - y * (x**2 + y**2),
    ]
    return dydt


t_span = (0, 20)
t_eval = np.linspace(t_span[0], t_span[1], 2000)

initial_conditions_lists = [
    [
        [5, -5],
    ],
    [
        [5, -5],
    ],
    [
        [5, -5],
        [0, 0.1],
    ],
]
mus = [-0.5, 0, 10]

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, mu in enumerate(mus):
    ax = axs[i]

    for initial_conditions in initial_conditions_lists[i]:
        sol = solve_ivp(f, t_span, initial_conditions, args=(mu,), t_eval=t_eval)
        ax.plot(sol.y[0], sol.y[1], color="black")

        idx = 20
        ax.annotate(
            "",
            xy=(sol.y[0][idx], sol.y[1][idx]),
            xytext=(sol.y[0][idx - 1], sol.y[1][idx - 1]),
            arrowprops=dict(arrowstyle="->", color="black", mutation_scale=30),
        )

    ax.grid(True)
    ax.set_xlim(-5, 5)
    ax.set_ylim(-5, 5)
    ax.set_xlabel(r"$x$", fontsize=16)
    ax.set_ylabel(r"$y$", fontsize=16)
    if i == 0:
        ax.set_title(r"$\mu < 0$", fontsize=19)
    elif i == 1:
        ax.set_title(r"$\mu = 0$", fontsize=19)
    elif i == 2:
        ax.set_title(r"$\mu > 0$", fontsize=19)

plt.show()
```
:::

![](/images/dynamic-bunki/28.png)

## 5. å†™åƒã®å‘¨æœŸç‚¹ã®åˆ†å²

ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\mu \in \mathbb{R}^p$ ã‚’ã‚‚ã¤è‡ªå¾‹ç³»å†™åƒ

$$
\vec{x} \mapsto f(\vec{x}, \mu), \quad \vec{x} \in \mathbb{R}^n
$$

ã‚’è€ƒãˆã‚‹ã€‚$\mu = \mu_0$ ã®ã¨ãã€$\vec{x} = \vec{x}_0$ ãŒ**ä¸å‹•ç‚¹**ï¼ˆã¾ãŸã¯å›ºå®šç‚¹ï¼‰ã§ã‚ã‚‹ã¨ã™ã‚‹ã€‚

$$
f(\vec{x}_0, \mu_0) = \vec{x}_0
$$

ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨åŒæ§˜ã«ä¸å‹•ç‚¹ $\vec{x}_0$ ã‹ã‚‰ã®å¤‰åˆ† $\xi \in \mathbb{R}^n$ ã«ã¤ã„ã¦ã®æ–¹ç¨‹å¼ã‚’ç«‹ã¦ã¦1æ¬¡è¿‘ä¼¼ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ç·šå½¢å†™åƒãŒå¾—ã‚‰ã‚Œã‚‹ã€‚

$$
\begin{align*}
&\xi \mapsto A\xi, \quad \xi \in \mathbb{R}^n, \\
&A = D_{\vec{x}} f(\vec{x}_0, \mu) = \left. \frac{\partial f}{\partial \vec{x}} \right|_{\vec{x}(t) = \vec{x}_0} = \left( \left. \frac{\partial f_i}{\partial x_j} \right|_{\vec{x}(t) = \vec{x}_0} \right)_{1 \leq i,j \leq n}
\end{align*}
$$

ãƒ¤ã‚³ãƒ“è¡Œåˆ— $A$ ã®ã©ã®å›ºæœ‰å€¤ã‚‚å˜ä½å†† $S = \{ \lambda \in \mathbb{C} | |\lambda| = 1 \}$ ä¸Šã«ãªã„ã¨ãã€ä¸å‹•ç‚¹ã¯**åŒæ›²å‹**ã§ã‚ã‚‹ã¨ã„ã†ã€‚$A$ ã®å›ºæœ‰å€¤ã™ã¹ã¦ãŒå˜ä½å††ã®å†…å´ã«ã‚ã‚‹ã¨ãä¸å‹•ç‚¹ã¯**å®‰å®š**ã§ã‚ã‚Šã€ã¾ãŸå°‘ãªãã¨ã‚‚1ã¤ã®å›ºæœ‰å€¤ãŒå˜ä½å††ã®å¤–å´ã«ã‚ã‚‹ã¨ãä¸å‹•ç‚¹ã¯**ä¸å®‰å®š**ã§ã‚ã‚‹ã€‚

å†™åƒ $f$ ã® $l$ å›åˆæˆå†™åƒã‚’ $f^l$ ã¨è¡¨ã™ã€‚$f^{m}$ï¼ˆ$1\leq m < l$ï¼‰ã§ã¯ä¸å‹•ç‚¹ã§ã¯ãªãã€$f^l$ ã§åˆã‚ã¦ä¸å‹•ç‚¹ã¨ãªã‚‹ç‚¹ã‚’ $l$ **å‘¨æœŸç‚¹**ã¨ã„ã†ã€‚

$$
f^l(\vec{l}, \mu) = \vec{l}, \quad f^m (\vec{l}, \mu) \ne \vec{l} \quad (1\leq m < l)
$$

$f$ ã®å‘¨æœŸç‚¹ã®åˆ†å²ã¯ $f^l$ ã®ä¸å‹•ç‚¹åˆ†å²ã‚’èª¿ã¹ãŸã‚‰ã‚ˆã„ã€‚ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨åŒæ§˜ã« $\mu = 0$ ã®ã¨ãã€åŸç‚¹ã«éåŒæ›²å‹ä¸å‹•ç‚¹ã‚’ã‚‚ã¤å ´åˆã‚’è€ƒãˆã‚‹ã€‚

### 1æ¬¡å…ƒå†™åƒã®å‘¨æœŸå€åˆ†å²

ã‚µãƒ‰ãƒ«ãƒ»ãƒãƒ¼ãƒ‰åˆ†å²ã€ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«åˆ†å²ã€ãƒ”ãƒƒãƒãƒ•ã‚©ãƒ¼ã‚¯åˆ†å²ã¯ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨åŒæ§˜ã«ç”Ÿã˜ã‚‹ã€‚ã“ã“ã§ã¯ã€**å‘¨æœŸå€åˆ†å²**ã¨ã„ã†2å‘¨æœŸç‚¹ãŒç™ºç”Ÿã™ã‚‹åˆ†å²ã‚’èª¬æ˜ã™ã‚‹ã€‚

1æ¬¡å…ƒå†™åƒ

$$
x \mapsto f(x, \mu) = -x -\mu x + x^3, \quad x \in \mathbb{R},\, \mu \in \mathbb{R}
$$

ã‚’è€ƒãˆã‚‹ã€‚$\mu$ ã‚’å¤‰åŒ–ã•ã›ã‚‹ã¨ã€ã“ã®å†™åƒã¯æ¬¡ã®ã‚ˆã†ãªå¤‰åŒ–ã‚’ã™ã‚‹ã€‚

- $\mu < 0$ ã‹ã¤ $|\mu| \ll 1$ï¼šä¸å‹•ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $-1 - \mu$ ã‚’æŒã¤ã€‚$|-1 - \mu| < 1$ ã‚ˆã‚Šå®‰å®šã€‚
- $\mu = 0$ï¼šä¸å‹•ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $-1$ ã‚’æŒã¤ã€‚
- $\mu > 0$ ã‹ã¤ $|\mu| \ll 1$ï¼šä¸å‹•ç‚¹ $O$ ã¯å›ºæœ‰å€¤ $-1 - \mu$ ã‚’æŒã¤ã€‚$|-1 - \mu| > 1$ ã‚ˆã‚Šä¸å®‰å®šã€‚2å‘¨æœŸç‚¹ $P^\pm = \pm \sqrt{\mu}$ ãŒå­˜åœ¨ã—å®‰å®šã€‚

2å‘¨æœŸç‚¹ã«ã¤ã„ã¦ã¯ã€

$$
\begin{align*}
f(\sqrt{\mu}, \mu) &= -\sqrt{\mu} - \mu \sqrt{\mu} + \mu \sqrt{\mu} = -\sqrt{\mu} \\
f(-\sqrt{\mu}, \mu) &= \sqrt{\mu} + \mu \sqrt{\mu} - \mu \sqrt{\mu} = \sqrt{\mu}
\end{align*}
$$

ã§ã‚ã‚‹ã“ã¨ã‹ã‚‰ã‚ã‹ã‚‹ã€‚ã¾ãŸã€

$$
D_x(f^2)(\pm\sqrt{\mu},\mu) = f_x(\mp\sqrt{\mu},\mu)f_x(\pm\sqrt{\mu},\mu) = (-1 + 2\mu)^2 < 1
$$

ãªã®ã§2å‘¨æœŸç‚¹ã¯å®‰å®šã§ã‚ã‚‹ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 
```python
import matplotlib.pyplot as plt
import numpy as np
import matplotlib.patches as patches

xs = np.linspace(-1, 1, 100)
mus = [-0.1, 0, 0.1]
init_xss = [[0.5], [0.5], [0.5]]

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, mu in enumerate(mus):
    ax = axs[i]
    fs = -xs - mu * xs + xs**3
    ax.plot(xs, fs, linewidth=1.5, color="red")
    ax.plot(xs, xs, color="black", linewidth=1.0)
    ax.plot(xs, -xs, color="black", linewidth=1.0)
    ax.axhline(0, color="black", linewidth=0.7)
    ax.axvline(0, color="black", linewidth=0.7)

    for init_x in init_xss[i]:
        x = init_x
        for _ in range(15):
            y = -x - mu * x + x**3
            ax.plot([x, x], [x, y], color="black")
            ax.plot([x, y], [y, y], color="black")
            arrow = patches.FancyArrowPatch(
                (x, x), (x, y), mutation_scale=15, color="black", arrowstyle="->"
            )
            ax.add_patch(arrow)
            arrow = patches.FancyArrowPatch(
                (x, y), (y, y), mutation_scale=15, color="black", arrowstyle="->"
            )
            ax.add_patch(arrow)
            x = y

    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.set_title(rf"$\mu = {mu}$", fontsize=19)
    ax.set_xlabel(r"$x$", fontsize=16)
    ax.set_ylabel(r"$f(x,\mu)$", fontsize=16)
    ax.grid(True)

plt.tight_layout()
plt.show()
```
:::

![](/images/dynamic-bunki/29.png)

### 2æ¬¡å…ƒå†™åƒ

2æ¬¡å…ƒå†™åƒ

$$
\begin{align*}
&\vec{x} \mapsto f(\vec{x}, \mu) = \left(f_1(x, y, \mu), f_2(x,y,\mu)\right)^T, \\
&\vec{x} = (x, y)^T \in \mathbb{R}^2, \quad \mu \in \mathbb{R}
\end{align*}
$$

ã®åˆ†å²ã‚’è€ƒãˆã‚‹ã€‚1æ¬¡å…ƒã¨åŒæ§˜ã« $\mu = 0$ ã®ã¨ã $\vec{x} = \vec{0}$ ã«éåŒæ›²å‹ä¸å‹•ç‚¹ã‚’æŒã¤å ´åˆã‚’èª¿ã¹ã‚‹ã€‚ãƒ¤ã‚³ãƒ“è¡Œåˆ—

$$
A = \begin{pmatrix}
(f_1)_x & (f_1)_y \\
(f_2)_x & (f_2)_y
\end{pmatrix}
$$

ã®å›ºæœ‰å€¤ã«ã‚ˆã£ã¦åˆ†å²ãŒæ±ºã¾ã‚‹ã€‚

ãƒ¤ã‚³ãƒ“è¡Œåˆ—ãŒå®Ÿå›ºæœ‰å€¤ $\lambda_1$, $\lambda_2$ ã‚’æŒã¡ $|\lambda_1| \ne 1$ ã¨ã™ã‚‹ã¨ã€åŸç‚¹ãŒéåŒæ›²å‹ä¸å‹•ç‚¹ã¨ãªã‚‹ã®ã¯ $\lambda_2 = 1$ ã¾ãŸã¯ $\lambda_2 = -1$ ã®ã¨ãã§ã‚ã‚‹ã€‚

- $\lambda_2 = 1$ï¼š**ã‚µãƒ‰ãƒ«ãƒãƒ¼ãƒ‰åˆ†å²**ã€‚æ‹˜æŸæ¡ä»¶ã‚’èª²ã™ã¨**ãƒˆãƒ©ãƒ³ã‚¹ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«åˆ†å²**ã€**ãƒ”ãƒƒãƒãƒ•ã‚©ãƒ¼ã‚¯åˆ†å²**ã€‚
- $\lambda_2 = -1$ï¼š**å‘¨æœŸå€åˆ†å²**

ç¾è±¡ã¨ã—ã¦ã¯1æ¬¡å…ƒã¨å¤‰ã‚ã‚‰ãšå›³ã‚‚ç…©é›‘ãªã®ã§ã€ã“ã‚Œã‚‰ã®å›³ã¯çœç•¥ã™ã‚‹ï¼ˆå‚è€ƒæ–‡çŒ®ã«åˆ†å²ã‚¤ãƒ¡ãƒ¼ã‚¸å›³ãŒã‚ã‚‹ï¼‰ã€‚

#### ãƒŠã‚¤ãƒãƒ«ã‚¯ãƒ»ã‚µãƒƒã‚«ãƒ¼åˆ†å²

ãƒ¤ã‚³ãƒ“è¡Œåˆ—ãŒçµ¶å¯¾å€¤1ã®è¤‡ç´ å…±å½¹å›ºæœ‰å€¤ã‚’ã‚‚ã¤å ´åˆã€**ãƒŠã‚¤ãƒãƒ«ã‚¯ãƒ»ã‚µãƒƒã‚«ãƒ¼åˆ†å²**ãŒç”Ÿã˜ã‚‹ã€‚2æ¬¡å…ƒå†™åƒã«æ¥µåº§æ¨™å¤‰æ›ã‚’æ–½ã—ãŸã¨ã

$$
\begin{align*}
&\begin{pmatrix} r \\ \theta \end{pmatrix} \mapsto \begin{pmatrix} g(r) \\ h(r, \theta) \end{pmatrix} = \begin{pmatrix}  r + d \mu r + a r^3 \\ \theta + c_0 + c_1 \mu + b r^2 \end{pmatrix} \\
&a, b, c_0, c_1, d : \text{const.}
\end{align*}
$$

ã§ä¸ãˆã‚‰ã‚Œã‚‹å†™åƒã‚’è€ƒãˆã‚‹ã€‚$g(0) = 0$ ã‚ˆã‚Šã€åŸç‚¹ã¯ä¸å‹•ç‚¹ã§ã‚ã‚‹ã€‚ãƒ¤ã‚³ãƒ“è¡Œåˆ—ã¯

$$
A(\mu) = (1 + d\mu) \begin{pmatrix}
\cos(c_0 + c_1 \mu) & -\sin(c_0 + c_1 \mu) \\
\sin(c_0 + c_1 \mu) & \cos(c_0 + c_1 \mu)
\end{pmatrix}
$$

ã§ã‚ã‚Šã€å›ºæœ‰å€¤ã¯

$$
(1 + d\mu) \exp \left( \pm(c_0 + c_1 \mu)i \right)
$$

ã¨ãªã‚‹ã€‚$d > 0$, $a < 0$ ã®ã¨ãã€ã“ã®å†™åƒã¯æ¬¡ã®ã‚ˆã†ãªæŒ™å‹•ã‚’ã™ã‚‹ã€‚

- $\mu < 0$ ã‹ã¤ $|\mu| \ll 1$ï¼šåŸç‚¹ã«å›ºæœ‰å€¤ $(1 + d\mu)\exp(\pm(c_0 + c_1\mu)i)$ ã‚’æŒã¤å®‰å®šä¸å‹•ç‚¹ãŒå­˜åœ¨ã™ã‚‹ã€‚
- $\mu = 0$ï¼šåŸç‚¹ã«å›ºæœ‰å€¤ $\exp(\pm c_0 i)$ ã‚’æŒã¤ä¸å‹•ç‚¹ã‚’ã‚‚ã¤ã€‚
- $\mu > 0$ ã‹ã¤ $|\mu| \ll 1$ï¼šåŸç‚¹ã«å›ºæœ‰å€¤ $(1 + d\mu)\exp(\pm(c_0 + c_1\mu)i)$ ã‚’æŒã¤ä¸å®‰å®šä¸å‹•ç‚¹ãŒå­˜åœ¨ã™ã‚‹ã€‚ãã®å‘¨å›²ã«åŠå¾„ $r = \sqrt{-d\mu/a}$ ã®ä¸å¤‰å††ã‚’æŒã¤ã€‚

ã“ã®ã‚ˆã†ã«å®‰å®šä¸å‹•ç‚¹ãŒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å¤‰åŒ–ã«ä¼´ã£ã¦ä¸å®‰å®šåŒ–ã—ã€ãã®å‘¨å›²ã«å®‰å®šãªä¸å¤‰å††ãŒç™ºç”Ÿã™ã‚‹åˆ†å²ã‚’**ãƒŠã‚¤ãƒãƒ«ã‚¯ãƒ»ã‚µãƒƒã‚«ãƒ¼åˆ†å²**ã¨ã„ã†ã€‚

:::details pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ 

```python
import matplotlib.pyplot as plt
import numpy as np


a = -0.1
b = 0.01
c0 = 0.2
c1 = 0
d = 1


def g(r, mu):
    return r + d * mu * r + a * r**3


rs = np.linspace(-4, 4, 1000)
mus = [-0.1, 0, 0.1]

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, mu in enumerate(mus):
    ax = axs[i]
    gs = g(rs, mu)

    ax.plot(rs, gs, linewidth=1.5, color="red")
    ax.plot(rs, rs, color="black", linewidth=1.0)
    ax.axhline(0, color="black", linewidth=0.7)
    ax.axvline(0, color="black", linewidth=0.7)

    ax.set_xlim(-4, 4)
    ax.set_ylim(-4, 4)
    ax.set_title(rf"$\mu = {mu}$, d > 0, a < 0", fontsize=19)
    ax.set_xlabel(r"$r$", fontsize=16)
    ax.set_ylabel(r"$g(r)$", fontsize=16)
    ax.grid(True)

plt.tight_layout()
plt.show()
```

```python
import matplotlib.pyplot as plt
import numpy as np


a = -0.1
b = 0.01
c0 = 0.2
c1 = 0
d = 1


def g(r, mu):
    return r + d * mu * r + a * r**3


def h(r, theta, mu):
    return theta + c0 + c1 * mu + b * r**2


mus = [-0.1, 0, 0.1]

fig, axs = plt.subplots(1, 3, figsize=(18, 6))

for i, mu in enumerate(mus):
    ax = axs[i]

    r0 = 0.7
    theta0 = 0
    x0 = r0 * np.cos(theta0)
    y0 = r0 * np.sin(theta0)
    ax.scatter(x0, y0, marker="o", color="blue")

    for _ in range(100):
        r1 = g(r0, mu)
        theta1 = h(r0, theta0, mu)
        x1 = r1 * np.cos(theta1)
        y1 = r1 * np.sin(theta1)
        ax.scatter(x1, y1, marker="o", color="blue")
        ax.annotate(
            "",
            xy=(x1, y1),
            xytext=(x0, y0),
            arrowprops=dict(arrowstyle="->", color="black"),
        )
        x0 = x1
        y0 = y1
        r0 = r1
        theta0 = theta1

    ax.set_xlim(-1, 1)
    ax.set_ylim(-1, 1)
    ax.set_title(rf"$\mu = {mu}$, d > 0, a < 0", fontsize=19)
    ax.set_xlabel(r"$x$", fontsize=16)
    ax.set_ylabel(r"$y$", fontsize=16)
    ax.grid(True)

plt.tight_layout()
plt.show()
```

:::

![](/images/dynamic-bunki/30.png)
![](/images/dynamic-bunki/31.png)

## å‚è€ƒæ–‡çŒ®

- å°å®¤å…ƒæ”¿[ã€æ–°ç‰ˆ åŸºç¤ã‹ã‚‰ã®åŠ›å­¦ç³» åˆ†å²è§£æã‹ã‚‰ã‚«ã‚ªã‚¹çš„éæ­´ã¸ã€](https://www.saiensu.co.jp/search/?isbn=978-4-7819-1118-2&y=2005)
- å·ä¸Šåš[ã€éç·šå½¢ç¾è±¡å…¥é–€ã€](http://cms.db.tokushima-u.ac.jp/DAV/person/S10723/%e5%9b%9e%e8%b7%af%e3%81%a8%e9%9d%9e%e7%b7%9a%e5%bd%a2/NonlinearPhenomena.pdf)
- å¤§è²«ç¾©éƒã€å‰ç”°æ˜¥å¤«[ã€å²©æ³¢è¬›åº§ ç¾ä»£ã®ç‰©ç†å­¦ 1 åŠ›å­¦ã€](https://www.iwanami.co.jp/book/b475700.html)
- å‰ç”°å–„ç« ã€æ°¸é•·ç›´äººã€çŸ³æ‘ç›´ä¹‹ã€è¥¿æˆæ´»è£•[ã€æ±äº¬å¤§å­¦å·¥å­¦æ•™ç¨‹ éç·šå½¢æ•°å­¦ã€](https://www.maruzen-publishing.co.jp/item/?book_no=294969)